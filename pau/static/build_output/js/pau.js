window.Modernizr=function(e,t,n){function r(e){b.cssText=e}function o(e,t){return r(S.join(e+";")+(t||""))}function i(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function c(e,t){for(var r in e){var o=e[r];if(!a(o,"-")&&b[o]!==n)return"pfx"==t?o:!0}return!1}function s(e,t,r){for(var o in e){var a=t[e[o]];if(a!==n)return r===!1?e[o]:i(a,"function")?a.bind(r||t):a}return!1}function u(e,t,n){var r=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+C.join(r+" ")+r).split(" ");return i(t,"string")||i(t,"undefined")?c(o,t):(o=(e+" "+k.join(r+" ")+r).split(" "),s(o,t,n))}function l(){m.input=function(n){for(var r=0,o=n.length;o>r;r++)z[n[r]]=!!(n[r]in w);return z.list&&(z.list=!(!t.createElement("datalist")||!e.HTMLDataListElement)),z}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),m.inputtypes=function(e){for(var r,o,i,a=0,c=e.length;c>a;a++)w.setAttribute("type",o=e[a]),r="text"!==w.type,r&&(w.value=x,w.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(o)&&w.style.WebkitAppearance!==n?(v.appendChild(w),i=t.defaultView,r=i.getComputedStyle&&"textfield"!==i.getComputedStyle(w,null).WebkitAppearance&&0!==w.offsetHeight,v.removeChild(w)):/^(search|tel)$/.test(o)||(r=/^(url|email)$/.test(o)?w.checkValidity&&w.checkValidity()===!1:w.value!=x)),j[e[a]]=!!r;return j}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,f,p="2.6.2",m={},g=!0,v=t.documentElement,h="modernizr",y=t.createElement(h),b=y.style,w=t.createElement("input"),x=":)",E={}.toString,S=" -webkit- -moz- -o- -ms- ".split(" "),T="Webkit Moz O ms",C=T.split(" "),k=T.toLowerCase().split(" "),M={svg:"http://www.w3.org/2000/svg"},P={},j={},z={},N=[],$=N.slice,A=function(e,n,r,o){var i,a,c,s,u=t.createElement("div"),l=t.body,d=l||t.createElement("body");if(parseInt(r,10))for(;r--;)c=t.createElement("div"),c.id=o?o[r]:h+(r+1),u.appendChild(c);return i=["&#173;",'<style id="s',h,'">',e,"</style>"].join(""),u.id=h,(l?u:d).innerHTML+=i,d.appendChild(u),l||(d.style.background="",d.style.overflow="hidden",s=v.style.overflow,v.style.overflow="hidden",v.appendChild(d)),a=n(u,e),l?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),v.style.overflow=s),!!a},I=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var r;return A("@media "+t+" { #"+h+" { position: absolute; } }",function(t){r="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),r},R=function(){function e(e,o){o=o||t.createElement(r[e]||"div"),e="on"+e;var a=e in o;return a||(o.setAttribute||(o=t.createElement("div")),o.setAttribute&&o.removeAttribute&&(o.setAttribute(e,""),a=i(o[e],"function"),i(o[e],"undefined")||(o[e]=n),o.removeAttribute(e))),o=null,a}var r={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),D={}.hasOwnProperty;f=i(D,"undefined")||i(D.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return D.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=$.call(arguments,1),r=function(){if(this instanceof r){var o=function(){};o.prototype=t.prototype;var i=new o,a=t.apply(i,n.concat($.call(arguments)));return Object(a)===a?a:i}return t.apply(e,n.concat($.call(arguments)))};return r}),P.flexbox=function(){return u("flexWrap")},P.flexboxlegacy=function(){return u("boxDirection")},P.canvas=function(){var e=t.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},P.canvastext=function(){return!(!m.canvas||!i(t.createElement("canvas").getContext("2d").fillText,"function"))},P.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:A(["@media (",S.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n},P.geolocation=function(){return"geolocation"in navigator},P.postmessage=function(){return!!e.postMessage},P.websqldatabase=function(){return!!e.openDatabase},P.indexedDB=function(){return!!u("indexedDB",e)},P.hashchange=function(){return R("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},P.history=function(){return!(!e.history||!history.pushState)},P.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},P.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},P.rgba=function(){return r("background-color:rgba(150,255,150,.5)"),a(b.backgroundColor,"rgba")},P.hsla=function(){return r("background-color:hsla(120,40%,100%,.5)"),a(b.backgroundColor,"rgba")||a(b.backgroundColor,"hsla")},P.multiplebgs=function(){return r("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(b.background)},P.backgroundsize=function(){return u("backgroundSize")},P.borderimage=function(){return u("borderImage")},P.borderradius=function(){return u("borderRadius")},P.boxshadow=function(){return u("boxShadow")},P.textshadow=function(){return""===t.createElement("div").style.textShadow},P.opacity=function(){return o("opacity:.55"),/^0.55$/.test(b.opacity)},P.cssanimations=function(){return u("animationName")},P.csscolumns=function(){return u("columnCount")},P.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return r((e+"-webkit- ".split(" ").join(t+e)+S.join(n+e)).slice(0,-e.length)),a(b.backgroundImage,"gradient")},P.cssreflections=function(){return u("boxReflect")},P.csstransforms=function(){return!!u("transform")},P.csstransitions=function(){return u("transition")},P.fontface=function(){var e;return A('@font-face {font-family:"font";src:url("https://")}',function(n,r){var o=t.getElementById("smodernizr"),i=o.sheet||o.styleSheet,a=i?i.cssRules&&i.cssRules[0]?i.cssRules[0].cssText:i.cssText||"":"";e=/src/i.test(a)&&0===a.indexOf(r.split(" ")[0])}),e},P.generatedcontent=function(){var e;return A(["#",h,"{font:0/0 a}#",h,':after{content:"',x,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},P.video=function(){var e=t.createElement("video"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(r){}return n},P.audio=function(){var e=t.createElement("audio"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(r){}return n},P.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(e){return!1}},P.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(e){return!1}},P.webworkers=function(){return!!e.Worker},P.applicationcache=function(){return!!e.applicationCache},P.svg=function(){return!!t.createElementNS&&!!t.createElementNS(M.svg,"svg").createSVGRect},P.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==M.svg},P.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(E.call(t.createElementNS(M.svg,"animate")))},P.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(E.call(t.createElementNS(M.svg,"clipPath")))};for(var L in P)f(P,L)&&(d=L.toLowerCase(),m[d]=P[L](),N.push((m[d]?"":"no-")+d));return m.input||l(),m.addTest=function(e,t){if("object"==typeof e)for(var r in e)f(e,r)&&m.addTest(r,e[r]);else{if(e=e.toLowerCase(),m[e]!==n){var o=new RegExp("\\b(no-)?"+e+"\\b");v.className=v.className.replace(o,"")}t="function"==typeof t?t():t,"undefined"!=typeof g&&g&&(v.className+=" "+(t?"":"no-")+e),m[e]=t}return m},r(""),y=w=null,m._version=p,m._prefixes=S,m._domPrefixes=k,m._cssomPrefixes=C,m.mq=I,m.hasEvent=R,m.testProp=function(e){return c([e])},m.testAllProps=u,m.testStyles=A,m.prefixed=function(e,t,n){return t?u(e,t,n):u(e,"pfx")},v.className=v.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(g?" js "+N.join(" "):""),m}(this,this.document),Modernizr.addTest("filereader",function(){return!!(window.File&&window.FileList&&window.FileReader)}),Modernizr.addTest("filesystem",!!Modernizr.prefixed("requestFileSystem",window)),Modernizr.addTest("emoji",function(){if(!Modernizr.canvastext)return!1;var e=document.createElement("canvas"),t=e.getContext("2d");return t.textBaseline="top",t.font="32px Arial",t.fillText("ðŸ˜ƒ",0,0),0!==t.getImageData(16,16,1,1).data[0]});
!function(t){"use strict";var e=function(e,n){this.$element=t(e),this.options=t.extend({},t.fn.collapse.defaults,n),this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var e,n,i,s;if(!this.transitioning){if(e=this.dimension(),n=t.camelCase(["scroll",e].join("-")),i=this.$parent&&this.$parent.find("> .accordion-group > .in"),i&&i.length){if(s=i.data("collapse"),s&&s.transitioning)return;i.collapse("hide"),s||i.data("collapse",null)}this.$element[e](0),this.transition("addClass",t.Event("show"),"shown"),this.$element[e](this.$element[0][n])}},hide:function(){var e;this.transitioning||(e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",t.Event("hide"),"hidden"),this.$element[e](0))},reset:function(t){var e=this.dimension();return this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth,this.$element[null!==t?"addClass":"removeClass"]("collapse"),this},transition:function(e,n,i){var s=this,o=function(){"show"==n.type&&s.reset(),s.transitioning=0,s.$element.trigger(i)};this.$element.trigger(n),n.isDefaultPrevented()||(this.transitioning=1,this.$element[e]("in"),t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,o):o())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},t.fn.collapse=function(n){return this.each(function(){var i=t(this),s=i.data("collapse"),o="object"==typeof n&&n;s||i.data("collapse",s=new e(this,o)),"string"==typeof n&&s[n]()})},t.fn.collapse.defaults={toggle:!0},t.fn.collapse.Constructor=e,t(function(){t("body").on("click.collapse.data-api","[data-toggle=collapse]",function(e){var n,i=t(this),s=i.attr("data-target")||e.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=t(s).data("collapse")?"toggle":i.data();t(s).collapse(o)})})}(window.jQuery);
!function(o){"use strict";function t(){o(n).parent().removeClass("open")}var n='[data-toggle="dropdown"]',a=function(t){var n=o(t).on("click.dropdown.data-api",this.toggle);o("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};a.prototype={constructor:a,toggle:function(){var n,a,r,d=o(this);if(!d.is(".disabled, :disabled"))return a=d.attr("data-target"),a||(a=d.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,"")),n=o(a),n.length||(n=d.parent()),r=n.hasClass("open"),t(),r||n.toggleClass("open"),!1}},o.fn.dropdown=function(t){return this.each(function(){var n=o(this),r=n.data("dropdown");r||n.data("dropdown",r=new a(this)),"string"==typeof t&&r[t].call(n)})},o.fn.dropdown.Constructor=a,o(function(){o("html").on("click.dropdown.data-api",t),o("body").on("click.dropdown",".dropdown form",function(o){o.stopPropagation()}).on("click.dropdown.data-api",n,a.prototype.toggle)})}(window.jQuery);
!function(t){"use strict";function e(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),s.call(e)},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),s.call(e)})}function s(){this.$element.hide().trigger("hidden"),i.call(this)}function i(e){var s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=t.support.transition&&s;this.$backdrop=t('<div class="modal-backdrop '+s+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(t.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,t.proxy(o,this)):o.call(this)):e&&e()}function o(){this.$backdrop.remove(),this.$backdrop=null}function n(){var e=this;this.isShown&&this.options.keyboard?t(document).on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||t(document).off("keyup.dismiss.modal")}var a=function(e,s){this.options=s,this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this))};a.prototype={constructor:a,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,s=t.Event("show");this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(t("body").addClass("modal-open"),this.isShown=!0,n.call(this),i.call(this,function(){var s=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),s&&e.$element[0].offsetWidth,e.$element.addClass("in"),s?e.$element.one(t.support.transition.end,function(){e.$element.trigger("shown")}):e.$element.trigger("shown")}))},hide:function(i){i&&i.preventDefault();i=t.Event("hide"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented()&&(this.isShown=!1,t("body").removeClass("modal-open"),n.call(this),this.$element.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?e.call(this):s.call(this))}},t.fn.modal=function(e){return this.each(function(){var s=t(this),i=s.data("modal"),o=t.extend({},t.fn.modal.defaults,s.data(),"object"==typeof e&&e);i||s.data("modal",i=new a(this,o)),"string"==typeof e?i[e]():o.show&&i.show()})},t.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},t.fn.modal.Constructor=a,t(function(){t("body").on("click.modal.data-api",'[data-toggle="modal"]',function(e){var s,i=t(this),o=t(i.attr("data-target")||(s=i.attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")),n=o.data("modal")?"toggle":t.extend({},o.data(),i.data());e.preventDefault(),o.modal(n)})})}(window.jQuery);
jQuery.cookie=function(e,i,o){if("undefined"==typeof i){var n=null;if(document.cookie&&""!=document.cookie)for(var r=document.cookie.split(";"),t=0;t<r.length;t++){var p=jQuery.trim(r[t]);if(p.substring(0,e.length+1)==e+"="){n=decodeURIComponent(p.substring(e.length+1));break}}return n}o=o||{},null===i&&(i="",o.expires=-1);var u="";if(o.expires&&("number"==typeof o.expires||o.expires.toUTCString)){var s;"number"==typeof o.expires?(s=new Date,s.setTime(s.getTime()+24*o.expires*60*60*1e3)):s=o.expires,u="; expires="+s.toUTCString()}var a=o.path?"; path="+o.path:"",c=o.domain?"; domain="+o.domain:"",m=o.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(i),u,a,c,m].join("")};
!function(e){function t(t){var a={},l=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!l.test(t.name)&&(a[t.name]=t.value)}),a}function a(){var t=e(this);t.val()===t.attr("placeholder")&&t.hasClass("placeholder")&&(t.data("placeholder-password")?t.hide().next().attr("id",t.removeAttr("id").data("placeholder-id")).show().focus():t.val("").removeClass("placeholder"))}function l(){var l,r=e(this),d=this.id;if(""===r.val()){if(r.is(":password")){if(!r.data("placeholder-textinput")){try{l=r.clone().attr({type:"text"})}catch(o){l=e("<input>").attr(e.extend(t(this),{type:"text"}))}l.removeAttr("name").data("placeholder-password",!0).data("placeholder-id",d).bind("focus.placeholder",a),r.data("placeholder-textinput",l).data("placeholder-id",d).before(l)}r=r.removeAttr("id").hide().prev().attr("id",d).show()}r.addClass("placeholder").val(r.attr("placeholder"))}else r.removeClass("placeholder")}var r="placeholder"in document.createElement("input"),d="placeholder"in document.createElement("textarea");r&&d?(e.fn.placeholder=function(){return this},e.fn.placeholder.input=e.fn.placeholder.textarea=!0):(e.fn.placeholder=function(){return this.filter((r?"textarea":":input")+"[placeholder]").bind("focus.placeholder",a).bind("blur.placeholder",l).trigger("blur.placeholder").end()},e.fn.placeholder.input=r,e.fn.placeholder.textarea=d),e(function(){e("form").bind("submit.placeholder",function(){var t=e(".placeholder",this).each(a);setTimeout(function(){t.each(l)},10)})}),e(window).bind("unload.placeholder",function(){e(".placeholder").val("")})}(jQuery);
!function(t){var e="0.9.3",i={isMsie:function(){var t=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return t?parseInt(t[2],10):!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},bind:t.proxy,bindAll:function(e){var i;for(var n in e)t.isFunction(i=e[n])&&(e[n]=t.proxy(i,e))},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},each:t.each,map:t.map,filter:t.grep,every:function(e,i){var n=!0;return e?(t.each(e,function(t,s){return(n=i.call(null,s,t,e))?void 0:!1}),!!n):n},some:function(e,i){var n=!1;return e?(t.each(e,function(t,s){return(n=i.call(null,s,t,e))?!1:void 0}),!!n):n},mixin:t.extend,getUniqueId:function(){var t=0;return function(){return t++}}(),defer:function(t){setTimeout(t,0)},debounce:function(t,e,i){var n,s;return function(){var r,o,u=this,a=arguments;return r=function(){n=null,i||(s=t.apply(u,a))},o=i&&!n,clearTimeout(n),n=setTimeout(r,e),o&&(s=t.apply(u,a)),s}},throttle:function(t,e){var i,n,s,r,o,u;return o=0,u=function(){o=new Date,s=null,r=t.apply(i,n)},function(){var a=new Date,c=e-(a-o);return i=this,n=arguments,0>=c?(clearTimeout(s),s=null,o=a,r=t.apply(i,n)):s||(s=setTimeout(u,c)),r}},tokenizeQuery:function(e){return t.trim(e).toLowerCase().split(/[\s]+/)},tokenizeText:function(e){return t.trim(e).toLowerCase().split(/[\s\-_]+/)},getProtocol:function(){return location.protocol},noop:function(){}},n=function(){var t=/\s+/;return{on:function(e,i){var n;if(!i)return this;for(this._callbacks=this._callbacks||{},e=e.split(t);n=e.shift();)this._callbacks[n]=this._callbacks[n]||[],this._callbacks[n].push(i);return this},trigger:function(e,i){var n,s;if(!this._callbacks)return this;for(e=e.split(t);n=e.shift();)if(s=this._callbacks[n])for(var r=0;r<s.length;r+=1)s[r].call(this,{type:n,data:i});return this}}}(),s=function(){function e(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var n="typeahead:";return i.mixin(e.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger(n+t,e)}}),e}(),r=function(){function t(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function e(){return(new Date).getTime()}function n(t){return JSON.stringify(i.isUndefined(t)?null:t)}function s(t){return JSON.parse(t)}var r,o;try{r=window.localStorage,r.setItem("~~~","!"),r.removeItem("~~~")}catch(u){r=null}return o=r&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(t){return this.isExpired(t)&&this.remove(t),s(r.getItem(this._prefix(t)))},set:function(t,s,o){return i.isNumber(o)?r.setItem(this._ttlKey(t),n(e()+o)):r.removeItem(this._ttlKey(t)),r.setItem(this._prefix(t),n(s))},remove:function(t){return r.removeItem(this._ttlKey(t)),r.removeItem(this._prefix(t)),this},clear:function(){var t,e,i=[],n=r.length;for(t=0;n>t;t++)(e=r.key(t)).match(this.keyMatcher)&&i.push(e.replace(this.keyMatcher,""));for(t=i.length;t--;)this.remove(i[t]);return this},isExpired:function(t){var n=s(r.getItem(this._ttlKey(t)));return i.isNumber(n)&&e()>n?!0:!1}}:{get:i.noop,set:i.noop,remove:i.noop,clear:i.noop,isExpired:i.noop},i.mixin(t.prototype,o),t}(),o=function(){function t(t){i.bindAll(this),t=t||{},this.sizeLimit=t.sizeLimit||10,this.cache={},this.cachedKeysByAge=[]}return i.mixin(t.prototype,{get:function(t){return this.cache[t]},set:function(t,e){var i;this.cachedKeysByAge.length===this.sizeLimit&&(i=this.cachedKeysByAge.shift(),delete this.cache[i]),this.cache[t]=e,this.cachedKeysByAge.push(t)}}),t}(),u=function(){function e(t){i.bindAll(this),t=i.isString(t)?{url:t}:t,a=a||new o,u=i.isNumber(t.maxParallelRequests)?t.maxParallelRequests:u||6,this.url=t.url,this.wildcard=t.wildcard||"%QUERY",this.filter=t.filter,this.replace=t.replace,this.ajaxSettings={type:"get",cache:t.cache,timeout:t.timeout,dataType:t.dataType||"json",beforeSend:t.beforeSend},this._get=(/^throttle$/i.test(t.rateLimitFn)?i.throttle:i.debounce)(this._get,t.rateLimitWait||300)}function n(){c++}function s(){c--}function r(){return u>c}var u,a,c=0,h={};return i.mixin(e.prototype,{_get:function(t,e){function i(i){var s=n.filter?n.filter(i):i;e&&e(s),a.set(t,i)}var n=this;r()?this._sendRequest(t).done(i):this.onDeckRequestArgs=[].slice.call(arguments,0)},_sendRequest:function(e){function i(){s(),h[e]=null,r.onDeckRequestArgs&&(r._get.apply(r,r.onDeckRequestArgs),r.onDeckRequestArgs=null)}var r=this,o=h[e];return o||(n(),o=h[e]=t.ajax(e,this.ajaxSettings).always(i)),o},get:function(t,e){var n,s,r=this,o=encodeURIComponent(t||"");return e=e||i.noop,n=this.replace?this.replace(this.url,o):this.url.replace(this.wildcard,o),(s=a.get(n))?i.defer(function(){e(r.filter?r.filter(s):s)}):this._get(n,e),!!s}}),e}(),a=function(){function n(e){i.bindAll(this),i.isString(e.template)&&!e.engine&&t.error("no template engine specified"),e.local||e.prefetch||e.remote||t.error("one of local, prefetch, or remote is required"),this.name=e.name||i.getUniqueId(),this.limit=e.limit||5,this.minLength=e.minLength||1,this.header=e.header,this.footer=e.footer,this.valueKey=e.valueKey||"value",this.template=s(e.template,e.engine,this.valueKey),this.local=e.local,this.prefetch=e.prefetch,this.remote=e.remote,this.itemHash={},this.adjacencyList={},this.storage=e.name?new r(e.name):null}function s(t,e,n){var s,r;return i.isFunction(t)?s=t:i.isString(t)?(r=e.compile(t),s=i.bind(r.render,r)):s=function(t){return"<p>"+t[n]+"</p>"},s}var o={thumbprint:"thumbprint",protocol:"protocol",itemHash:"itemHash",adjacencyList:"adjacencyList"};return i.mixin(n.prototype,{_processLocalData:function(t){this._mergeProcessedData(this._processData(t))},_loadPrefetchData:function(n){function s(t){var e=n.filter?n.filter(t):t,s=d._processData(e),r=s.itemHash,u=s.adjacencyList;d.storage&&(d.storage.set(o.itemHash,r,n.ttl),d.storage.set(o.adjacencyList,u,n.ttl),d.storage.set(o.thumbprint,p,n.ttl),d.storage.set(o.protocol,i.getProtocol(),n.ttl)),d._mergeProcessedData(s)}var r,u,a,c,h,l,d=this,p=e+(n.thumbprint||"");return this.storage&&(r=this.storage.get(o.thumbprint),u=this.storage.get(o.protocol),a=this.storage.get(o.itemHash),c=this.storage.get(o.adjacencyList)),h=r!==p||u!==i.getProtocol(),n=i.isString(n)?{url:n}:n,n.ttl=i.isNumber(n.ttl)?n.ttl:864e5,a&&c&&!h?(this._mergeProcessedData({itemHash:a,adjacencyList:c}),l=t.Deferred().resolve()):l=t.getJSON(n.url).done(s),l},_transformDatum:function(t){var e=i.isString(t)?t:t[this.valueKey],n=t.tokens||i.tokenizeText(e),s={value:e,tokens:n};return i.isString(t)?(s.datum={},s.datum[this.valueKey]=t):s.datum=t,s.tokens=i.filter(s.tokens,function(t){return!i.isBlankString(t)}),s.tokens=i.map(s.tokens,function(t){return t.toLowerCase()}),s},_processData:function(t){var e=this,n={},s={};return i.each(t,function(t,r){var o=e._transformDatum(r),u=i.getUniqueId(o.value);n[u]=o,i.each(o.tokens,function(t,e){var n=e.charAt(0),r=s[n]||(s[n]=[u]);!~i.indexOf(r,u)&&r.push(u)})}),{itemHash:n,adjacencyList:s}},_mergeProcessedData:function(t){var e=this;i.mixin(this.itemHash,t.itemHash),i.each(t.adjacencyList,function(t,i){var n=e.adjacencyList[t];e.adjacencyList[t]=n?n.concat(i):i})},_getLocalSuggestions:function(t){var e,n=this,s=[],r=[],o=[];return i.each(t,function(t,e){var n=e.charAt(0);!~i.indexOf(s,n)&&s.push(n)}),i.each(s,function(t,i){var s=n.adjacencyList[i];return s?(r.push(s),void((!e||s.length<e.length)&&(e=s))):!1}),r.length<s.length?[]:(i.each(e,function(e,s){var u,a,c=n.itemHash[s];u=i.every(r,function(t){return~i.indexOf(t,s)}),a=u&&i.every(t,function(t){return i.some(c.tokens,function(e){return 0===e.indexOf(t)})}),a&&o.push(c)}),o)},initialize:function(){var e;return this.local&&this._processLocalData(this.local),this.transport=this.remote?new u(this.remote):null,e=this.prefetch?this._loadPrefetchData(this.prefetch):t.Deferred().resolve(),this.local=this.prefetch=this.remote=null,this.initialize=function(){return e},e},getSuggestions:function(t,e){function n(t){r=r.slice(0),i.each(t,function(t,e){var n,s=o._transformDatum(e);return n=i.some(r,function(t){return s.value===t.value}),!n&&r.push(s),r.length<o.limit}),e&&e(r)}var s,r,o=this,u=!1;t.length<this.minLength||(s=i.tokenizeQuery(t),r=this._getLocalSuggestions(s).slice(0,this.limit),r.length<this.limit&&this.transport&&(u=this.transport.get(t,n)),!u&&e&&e(r))}}),n}(),c=function(){function e(e){var n=this;i.bindAll(this),this.specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},this.$hint=t(e.hint),this.$input=t(e.input).on("blur.tt",this._handleBlur).on("focus.tt",this._handleFocus).on("keydown.tt",this._handleSpecialKeyEvent),i.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){n.specialKeyCodeMap[t.which||t.keyCode]||i.defer(n._compareQueryToInputValue)}):this.$input.on("input.tt",this._compareQueryToInputValue),this.query=this.$input.val(),this.$overflowHelper=s(this.$input)}function s(e){return t("<span></span>").css({position:"absolute",left:"-9999px",visibility:"hidden",whiteSpace:"nowrap",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function r(t,e){return t=(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," "),e=(e||"").replace(/^\s*/g,"").replace(/\s{2,}/g," "),t===e}return i.mixin(e.prototype,n,{_handleFocus:function(){this.trigger("focused")},_handleBlur:function(){this.trigger("blured")},_handleSpecialKeyEvent:function(t){var e=this.specialKeyCodeMap[t.which||t.keyCode];e&&this.trigger(e+"Keyed",t)},_compareQueryToInputValue:function(){var t=this.getInputValue(),e=r(this.query,t),i=e?this.query.length!==t.length:!1;i?this.trigger("whitespaceChanged",{value:this.query}):e||this.trigger("queryChanged",{value:this.query=t})},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),!e&&this._compareQueryToInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(t){this.$hint.val(t)},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},isOverflow:function(){return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>this.$input.width()},isCursorAtEnd:function(){var t,e=this.$input.val().length,n=this.$input[0].selectionStart;return i.isNumber(n)?n===e:document.selection?(t=document.selection.createRange(),t.moveStart("character",-e),e===t.text.length):!0}}),e}(),h=function(){function e(e){i.bindAll(this),this.isOpen=!1,this.isEmpty=!0,this.isMouseOverDropdown=!1,this.$menu=t(e.menu).on("mouseenter.tt",this._handleMouseenter).on("mouseleave.tt",this._handleMouseleave).on("click.tt",".tt-suggestion",this._handleSelection).on("mouseover.tt",".tt-suggestion",this._handleMouseover)}function s(t){return t.data("suggestion")}var r={suggestionsList:'<span class="tt-suggestions"></span>'},o={suggestionsList:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"}};return i.mixin(e.prototype,n,{_handleMouseenter:function(){this.isMouseOverDropdown=!0},_handleMouseleave:function(){this.isMouseOverDropdown=!1},_handleMouseover:function(e){var i=t(e.currentTarget);this._getSuggestions().removeClass("tt-is-under-cursor"),i.addClass("tt-is-under-cursor")},_handleSelection:function(e){var i=t(e.currentTarget);this.trigger("suggestionSelected",s(i))},_show:function(){this.$menu.css("display","block")},_hide:function(){this.$menu.hide()},_moveCursor:function(t){var e,i,n,r;if(this.isVisible()){if(e=this._getSuggestions(),i=e.filter(".tt-is-under-cursor"),i.removeClass("tt-is-under-cursor"),n=e.index(i)+t,n=(n+1)%(e.length+1)-1,-1===n)return void this.trigger("cursorRemoved");-1>n&&(n=e.length-1),r=e.eq(n).addClass("tt-is-under-cursor"),this._ensureVisibility(r),this.trigger("cursorMoved",s(r))}},_getSuggestions:function(){return this.$menu.find(".tt-suggestions > .tt-suggestion")},_ensureVisibility:function(t){var e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),i=this.$menu.scrollTop(),n=t.position().top,s=n+t.outerHeight(!0);0>n?this.$menu.scrollTop(i+n):s>e&&this.$menu.scrollTop(i+(s-e))},destroy:function(){this.$menu.off(".tt"),this.$menu=null},isVisible:function(){return this.isOpen&&!this.isEmpty},closeUnlessMouseIsOverDropdown:function(){this.isMouseOverDropdown||this.close()},close:function(){this.isOpen&&(this.isOpen=!1,this.isMouseOverDropdown=!1,this._hide(),this.$menu.find(".tt-suggestions > .tt-suggestion").removeClass("tt-is-under-cursor"),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){var e={left:"0",right:"auto"},i={left:"auto",right:" 0"};this.$menu.css("ltr"===t?e:i)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getSuggestionUnderCursor:function(){var t=this._getSuggestions().filter(".tt-is-under-cursor").first();return t.length>0?s(t):null},getFirstSuggestion:function(){var t=this._getSuggestions().first();return t.length>0?s(t):null},renderSuggestions:function(e,n){var s,u,a,c,h,l="tt-dataset-"+e.name,d='<div class="tt-suggestion">%body</div>',p=this.$menu.find("."+l);0===p.length&&(u=t(r.suggestionsList).css(o.suggestionsList),p=t("<div></div>").addClass(l).append(e.header).append(u).append(e.footer).appendTo(this.$menu)),n.length>0?(this.isEmpty=!1,this.isOpen&&this._show(),a=document.createElement("div"),c=document.createDocumentFragment(),i.each(n,function(i,n){n.dataset=e.name,s=e.template(n.datum),a.innerHTML=d.replace("%body",s),h=t(a.firstChild).css(o.suggestion).data("suggestion",n),h.children().each(function(){t(this).css(o.suggestionChild)}),c.appendChild(h[0])}),p.show().find(".tt-suggestions").html(c)):this.clearSuggestions(e.name),this.trigger("suggestionsRendered")},clearSuggestions:function(t){var e=this.$menu.find(t?".tt-dataset-"+t:'[class^="tt-dataset-"]'),i=e.find(".tt-suggestions");e.hide(),i.empty(),0===this._getSuggestions().length&&(this.isEmpty=!0,this._hide())}}),e}(),l=function(){function e(t){var e,n,r;i.bindAll(this),this.$node=s(t.input),this.datasets=t.datasets,this.dir=null,this.eventBus=t.eventBus,e=this.$node.find(".tt-dropdown-menu"),n=this.$node.find(".tt-query"),r=this.$node.find(".tt-hint"),this.dropdownView=new h({menu:e}).on("suggestionSelected",this._handleSelection).on("cursorMoved",this._clearHint).on("cursorMoved",this._setInputValueToSuggestionUnderCursor).on("cursorRemoved",this._setInputValueToQuery).on("cursorRemoved",this._updateHint).on("suggestionsRendered",this._updateHint).on("opened",this._updateHint).on("closed",this._clearHint).on("opened closed",this._propagateEvent),this.inputView=new c({input:n,hint:r}).on("focused",this._openDropdown).on("blured",this._closeDropdown).on("blured",this._setInputValueToQuery).on("enterKeyed tabKeyed",this._handleSelection).on("queryChanged",this._clearHint).on("queryChanged",this._clearSuggestions).on("queryChanged",this._getSuggestions).on("whitespaceChanged",this._updateHint).on("queryChanged whitespaceChanged",this._openDropdown).on("queryChanged whitespaceChanged",this._setLanguageDirection).on("escKeyed",this._closeDropdown).on("escKeyed",this._setInputValueToQuery).on("tabKeyed upKeyed downKeyed",this._managePreventDefault).on("upKeyed downKeyed",this._moveDropdownCursor).on("upKeyed downKeyed",this._openDropdown).on("tabKeyed leftKeyed rightKeyed",this._autocomplete)}function s(e){var i=t(o.wrapper),n=t(o.dropdown),s=t(e),r=t(o.hint);i=i.css(u.wrapper),n=n.css(u.dropdown),r.css(u.hint).css({backgroundAttachment:s.css("background-attachment"),backgroundClip:s.css("background-clip"),backgroundColor:s.css("background-color"),backgroundImage:s.css("background-image"),backgroundOrigin:s.css("background-origin"),backgroundPosition:s.css("background-position"),backgroundRepeat:s.css("background-repeat"),backgroundSize:s.css("background-size")}),s.data("ttAttrs",{dir:s.attr("dir"),autocomplete:s.attr("autocomplete"),spellcheck:s.attr("spellcheck"),style:s.attr("style")}),s.addClass("tt-query").attr({autocomplete:"off",spellcheck:!1}).css(u.query);try{!s.attr("dir")&&s.attr("dir","auto")}catch(a){}return s.wrap(i).parent().prepend(r).append(n)}function r(t){var e=t.find(".tt-query");i.each(e.data("ttAttrs"),function(t,n){i.isUndefined(n)?e.removeAttr(t):e.attr(t,n)}),e.detach().removeData("ttAttrs").removeClass("tt-query").insertAfter(t),t.remove()}var o={wrapper:'<span class="twitter-typeahead"></span>',hint:'<input class="tt-hint" type="text" autocomplete="off" spellcheck="off" disabled>',dropdown:'<span class="tt-dropdown-menu"></span>'},u={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},query:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"}};return i.isMsie()&&i.mixin(u.query,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),i.isMsie()&&i.isMsie()<=7&&(i.mixin(u.wrapper,{display:"inline",zoom:"1"}),i.mixin(u.query,{marginTop:"-1px"})),i.mixin(e.prototype,n,{_managePreventDefault:function(t){var e,i,n=t.data,s=!1;switch(t.type){case"tabKeyed":e=this.inputView.getHintValue(),i=this.inputView.getInputValue(),s=e&&e!==i;break;case"upKeyed":case"downKeyed":s=!n.shiftKey&&!n.ctrlKey&&!n.metaKey}s&&n.preventDefault()},_setLanguageDirection:function(){var t=this.inputView.getLanguageDirection();t!==this.dir&&(this.dir=t,this.$node.css("direction",t),this.dropdownView.setLanguageDirection(t))},_updateHint:function(){var t,e,n,s,r,o=this.dropdownView.getFirstSuggestion(),u=o?o.value:null,a=this.dropdownView.isVisible(),c=this.inputView.isOverflow();u&&a&&!c&&(t=this.inputView.getInputValue(),e=t.replace(/\s{2,}/g," ").replace(/^\s+/g,""),n=i.escapeRegExChars(e),s=new RegExp("^(?:"+n+")(.*$)","i"),r=s.exec(u),this.inputView.setHintValue(t+(r?r[1]:"")))},_clearHint:function(){this.inputView.setHintValue("")},_clearSuggestions:function(){this.dropdownView.clearSuggestions()},_setInputValueToQuery:function(){this.inputView.setInputValue(this.inputView.getQuery())},_setInputValueToSuggestionUnderCursor:function(t){var e=t.data;this.inputView.setInputValue(e.value,!0)},_openDropdown:function(){this.dropdownView.open()},_closeDropdown:function(t){this.dropdownView["blured"===t.type?"closeUnlessMouseIsOverDropdown":"close"]()},_moveDropdownCursor:function(t){var e=t.data;e.shiftKey||e.ctrlKey||e.metaKey||this.dropdownView["upKeyed"===t.type?"moveCursorUp":"moveCursorDown"]()},_handleSelection:function(t){var e="suggestionSelected"===t.type,n=e?t.data:this.dropdownView.getSuggestionUnderCursor();n&&(this.inputView.setInputValue(n.value),e?this.inputView.focus():t.data.preventDefault(),e&&i.isMsie()?i.defer(this.dropdownView.close):this.dropdownView.close(),this.eventBus.trigger("selected",n.datum,n.dataset))},_getSuggestions:function(){var t=this,e=this.inputView.getQuery();i.isBlankString(e)||i.each(this.datasets,function(i,n){n.getSuggestions(e,function(i){e===t.inputView.getQuery()&&t.dropdownView.renderSuggestions(n,i)})})},_autocomplete:function(t){var e,i,n,s,r;("rightKeyed"!==t.type&&"leftKeyed"!==t.type||(e=this.inputView.isCursorAtEnd(),i="ltr"===this.inputView.getLanguageDirection()?"leftKeyed"===t.type:"rightKeyed"===t.type,e&&!i))&&(n=this.inputView.getQuery(),s=this.inputView.getHintValue(),""!==s&&n!==s&&(r=this.dropdownView.getFirstSuggestion(),this.inputView.setInputValue(r.value),this.eventBus.trigger("autocompleted",r.datum,r.dataset)))},_propagateEvent:function(t){this.eventBus.trigger(t.type)},destroy:function(){this.inputView.destroy(),this.dropdownView.destroy(),r(this.$node),this.$node=null},setQuery:function(t){this.inputView.setQuery(t),this.inputView.setInputValue(t),this._clearHint(),this._clearSuggestions(),this._getSuggestions()}}),e}();!function(){var e,n={},r="ttView";e={initialize:function(e){function o(){var e,n=t(this),o=new s({el:n});e=i.map(u,function(t){return t.initialize()}),n.data(r,new l({input:n,eventBus:o=new s({el:n}),datasets:u})),t.when.apply(t,e).always(function(){i.defer(function(){o.trigger("initialized")})})}var u;return e=i.isArray(e)?e:[e],0===e.length&&t.error("no datasets provided"),u=i.map(e,function(t){var e=n[t.name]?n[t.name]:new a(t);return t.name&&(n[t.name]=e),e}),this.each(o)},destroy:function(){function e(){var e=t(this),i=e.data(r);i&&(i.destroy(),e.removeData(r))}return this.each(e)},setQuery:function(e){function i(){var i=t(this).data(r);i&&i.setQuery(e)}return this.each(i)}},jQuery.fn.typeahead=function(t){return e[t]?e[t].apply(this,[].slice.call(arguments,1)):e.initialize.apply(this,arguments)}}()}(window.jQuery);
var JSON;JSON||(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var r,n,o,f,u,i=gap,p=e[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),"function"==typeof rep&&(p=rep.call(e,t,p)),typeof p){case"string":return quote(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(gap+=indent,u=[],"[object Array]"===Object.prototype.toString.apply(p)){for(f=p.length,r=0;f>r;r+=1)u[r]=str(r,p)||"null";return o=0===u.length?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+i+"]":"["+u.join(",")+"]",gap=i,o}if(rep&&"object"==typeof rep)for(f=rep.length,r=0;f>r;r+=1)"string"==typeof rep[r]&&(n=rep[r],o=str(n,p),o&&u.push(quote(n)+(gap?": ":":")+o));else for(n in p)Object.prototype.hasOwnProperty.call(p,n)&&(o=str(n,p),o&&u.push(quote(n)+(gap?": ":":")+o));return o=0===u.length?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+i+"}":"{"+u.join(",")+"}",gap=i,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;r>n;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var r,n,o=t[e];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n=walk(o,r),void 0!==n?o[r]=n:delete o[r]);return reviver.call(t,e,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();
!function(n){var u,i={};n.publish=function(c,t){return u=i[c]&&n.each(i[c],function(){this.apply(n,t||[])}),!1},n.subscribe=function(n,u){return i[n]||(i[n]=[]),i[n].push(u),[n,u]},n.unsubscribe=function(c){var t=c[0];u=i[t]&&n.each(i[t],function(n){this==c[1]&&i[t].splice(n,1)})}}(jQuery);
(function(){function n(t,r,e){if(t===r)return 0!==t||1/t==1/r;if(null==t||null==r)return t===r;if(t._chain&&(t=t._wrapped),r._chain&&(r=r._wrapped),t.isEqual&&A.isFunction(t.isEqual))return t.isEqual(r);if(r.isEqual&&A.isFunction(r.isEqual))return r.isEqual(t);var u=f.call(t);if(u!=f.call(r))return!1;switch(u){case"[object String]":return t==String(r);case"[object Number]":return t!=+t?r!=+r:0==t?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if("object"!=typeof t||"object"!=typeof r)return!1;for(var i=e.length;i--;)if(e[i]==t)return!0;e.push(t);var a=0,c=!0;if("[object Array]"==u){if(a=t.length,c=a==r.length)for(;a--&&(c=a in t==a in r&&n(t[a],r[a],e)););}else{if("constructor"in t!="constructor"in r||t.constructor!=r.constructor)return!1;for(var o in t)if(s.call(t,o)&&(a++,!(c=s.call(r,o)&&n(t[o],r[o],e))))break;if(c){for(o in r)if(s.call(r,o)&&!a--)break;c=!a}}return e.pop(),c}var t=this,r=t._,e={},u=Array.prototype,i=Object.prototype,a=Function.prototype,c=u.slice,o=u.concat,l=u.unshift,f=i.toString,s=i.hasOwnProperty,p=u.forEach,g=u.map,d=u.reduce,h=u.reduceRight,v=u.filter,m=u.every,y=u.some,b=u.indexOf,x=u.lastIndexOf,_=Array.isArray,j=Object.keys,w=a.bind,A=function(n){return new F(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=A),exports._=A):"function"==typeof define&&define.amd?define("underscore",function(){return A}):t._=A,A.VERSION="1.2.3";var E=A.each=A.forEach=function(n,t,r){if(null!=n)if(p&&n.forEach===p)n.forEach(t,r);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(u in n&&t.call(r,n[u],u,n)===e)return}else for(var a in n)if(s.call(n,a)&&t.call(r,n[a],a,n)===e)return};A.map=function(n,t,r){var e=[];return null==n?e:g&&n.map===g?n.map(t,r):(E(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)},A.reduce=A.foldl=A.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),d&&n.reduce===d)return e&&(t=A.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(E(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError("Reduce of empty array with no initial value");return r},A.reduceRight=A.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduceRight===h)return e&&(t=A.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=A.toArray(n).reverse();return e&&!u&&(t=A.bind(t,e)),u?A.reduce(i,t,r,e):A.reduce(i,t)},A.find=A.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},A.filter=A.select=function(n,t,r){var e=[];return null==n?e:v&&n.filter===v?n.filter(t,r):(E(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},A.reject=function(n,t,r){var e=[];return null==n?e:(E(n,function(n,u,i){t.call(r,n,u,i)||(e[e.length]=n)}),e)},A.every=A.all=function(n,t,r){var u=!0;return null==n?u:m&&n.every===m?n.every(t,r):(E(n,function(n,i,a){return(u=u&&t.call(r,n,i,a))?void 0:e}),u)};var O=A.some=A.any=function(n,t,r){t||(t=A.identity);var u=!1;return null==n?u:y&&n.some===y?n.some(t,r):(E(n,function(n,i,a){return u||(u=t.call(r,n,i,a))?e:void 0}),!!u)};A.include=A.contains=function(n,t){var r=!1;return null==n?r:b&&n.indexOf===b?-1!=n.indexOf(t):r=O(n,function(n){return n===t})},A.invoke=function(n,t){var r=c.call(arguments,2);return A.map(n,function(n){return(t.call?t||n:n[t]).apply(n,r)})},A.pluck=function(n,t){return A.map(n,function(n){return n[t]})},A.max=function(n,t,r){if(!t&&A.isArray(n))return Math.max.apply(Math,n);if(!t&&A.isEmpty(n))return-1/0;var e={computed:-1/0};return E(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},A.min=function(n,t,r){if(!t&&A.isArray(n))return Math.min.apply(Math,n);if(!t&&A.isEmpty(n))return 1/0;var e={computed:1/0};return E(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},A.shuffle=function(n){var t,r=[];return E(n,function(n,e){0==e?r[0]=n:(t=Math.floor(Math.random()*(e+1)),r[e]=r[t],r[t]=n)}),r},A.sortBy=function(n,t,r){return A.pluck(A.map(n,function(n,e,u){return{value:n,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;return e>r?-1:r>e?1:0}),"value")},A.groupBy=function(n,t){var r={},e=A.isFunction(t)?t:function(n){return n[t]};return E(n,function(n,t){var u=e(n,t);(r[u]||(r[u]=[])).push(n)}),r},A.sortedIndex=function(n,t,r){r||(r=A.identity);for(var e=0,u=n.length;u>e;){var i=e+u>>1;r(n[i])<r(t)?e=i+1:u=i}return e},A.toArray=function(n){return n?n.toArray?n.toArray():A.isArray(n)?c.call(n):A.isArguments(n)?c.call(n):A.values(n):[]},A.size=function(n){return A.toArray(n).length},A.first=A.head=function(n,t,r){return null==t||r?n[0]:c.call(n,0,t)},A.initial=function(n,t,r){return c.call(n,0,n.length-(null==t||r?1:t))},A.last=function(n,t,r){return null==t||r?n[n.length-1]:c.call(n,Math.max(n.length-t,0))},A.rest=A.tail=function(n,t,r){return c.call(n,null==t||r?1:t)},A.compact=function(n){return A.filter(n,function(n){return!!n})},A.flatten=function(n,t){return A.reduce(n,function(n,r){return A.isArray(r)?n.concat(t?r:A.flatten(r)):(n[n.length]=r,n)},[])},A.without=function(n){return A.difference(n,c.call(arguments,1))},A.uniq=A.unique=function(n,t,r){var e=r?A.map(n,r):n,u=[];return A.reduce(e,function(r,e,i){return 0!=i&&(t===!0?A.last(r)==e:A.include(r,e))||(r[r.length]=e,u[u.length]=n[i]),r},[]),u},A.union=function(){return A.uniq(A.flatten(arguments,!0))},A.intersection=A.intersect=function(n){var t=c.call(arguments,1);return A.filter(A.uniq(n),function(n){return A.every(t,function(t){return A.indexOf(t,n)>=0})})},A.difference=function(n){var t=A.flatten(c.call(arguments,1));return A.filter(n,function(n){return!A.include(t,n)})},A.zip=function(){for(var n=c.call(arguments),t=A.max(A.pluck(n,"length")),r=new Array(t),e=0;t>e;e++)r[e]=A.pluck(n,""+e);return r},A.indexOf=function(n,t,r){if(null==n)return-1;var e,u;if(r)return e=A.sortedIndex(n,t),n[e]===t?e:-1;if(b&&n.indexOf===b)return n.indexOf(t);for(e=0,u=n.length;u>e;e++)if(e in n&&n[e]===t)return e;return-1},A.lastIndexOf=function(n,t){if(null==n)return-1;if(x&&n.lastIndexOf===x)return n.lastIndexOf(t);for(var r=n.length;r--;)if(r in n&&n[r]===t)return r;return-1},A.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var q=function(){};A.bind=function(n,t){var r,e;if(n.bind===w&&w)return w.apply(n,c.call(arguments,1));if(!A.isFunction(n))throw new TypeError;return e=c.call(arguments,2),r=function(){if(!(this instanceof r))return n.apply(t,e.concat(c.call(arguments)));q.prototype=n.prototype;var u=new q,i=n.apply(u,e.concat(c.call(arguments)));return Object(i)===i?i:u}},A.bindAll=function(n){var t=c.call(arguments,1);return 0==t.length&&(t=A.functions(n)),E(t,function(t){n[t]=A.bind(n[t],n)}),n},A.memoize=function(n,t){var r={};return t||(t=A.identity),function(){var e=t.apply(this,arguments);return s.call(r,e)?r[e]:r[e]=n.apply(this,arguments)}},A.delay=function(n,t){var r=c.call(arguments,2);return setTimeout(function(){return n.apply(n,r)},t)},A.defer=function(n){return A.delay.apply(A,[n,1].concat(c.call(arguments,1)))},A.throttle=function(n,t){var r,e,u,i,a,c=A.debounce(function(){a=i=!1},t);return function(){r=this,e=arguments;var o=function(){u=null,a&&n.apply(r,e),c()};u||(u=setTimeout(o,t)),i?a=!0:n.apply(r,e),c(),i=!0}},A.debounce=function(n,t){var r;return function(){var e=this,u=arguments,i=function(){r=null,n.apply(e,u)};clearTimeout(r),r=setTimeout(i,t)}},A.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments))}},A.wrap=function(n,t){return function(){var r=o.apply([n],arguments);return t.apply(this,r)}},A.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},A.after=function(n,t){return 0>=n?t():function(){return--n<1?t.apply(this,arguments):void 0}},A.keys=j||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)s.call(n,r)&&(t[t.length]=r);return t},A.values=function(n){return A.map(n,A.identity)},A.functions=A.methods=function(n){var t=[];for(var r in n)A.isFunction(n[r])&&t.push(r);return t.sort()},A.extend=function(n){return E(c.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(n[r]=t[r])}),n},A.defaults=function(n){return E(c.call(arguments,1),function(t){for(var r in t)null==n[r]&&(n[r]=t[r])}),n},A.clone=function(n){return A.isObject(n)?A.isArray(n)?n.slice():A.extend({},n):n},A.tap=function(n,t){return t(n),n},A.isEqual=function(t,r){return n(t,r,[])},A.isEmpty=function(n){if(A.isArray(n)||A.isString(n))return 0===n.length;for(var t in n)if(s.call(n,t))return!1;return!0},A.isElement=function(n){return!(!n||1!=n.nodeType)},A.isArray=_||function(n){return"[object Array]"==f.call(n)},A.isObject=function(n){return n===Object(n)},A.isArguments=function(n){return"[object Arguments]"==f.call(n)},A.isArguments(arguments)||(A.isArguments=function(n){return!(!n||!s.call(n,"callee"))}),A.isFunction=function(n){return"[object Function]"==f.call(n)},A.isString=function(n){return"[object String]"==f.call(n)},A.isNumber=function(n){return"[object Number]"==f.call(n)},A.isNaN=function(n){return n!==n},A.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==f.call(n)},A.isDate=function(n){return"[object Date]"==f.call(n)},A.isRegExp=function(n){return"[object RegExp]"==f.call(n)},A.isNull=function(n){return null===n},A.isUndefined=function(n){return void 0===n},A.noConflict=function(){return t._=r,this},A.identity=function(n){return n},A.times=function(n,t,r){for(var e=0;n>e;e++)t.call(r,e)},A.escape=function(n){return(""+n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},A.mixin=function(n){E(A.functions(n),function(t){k(t,A[t]=n[t])})};var S=0;A.uniqueId=function(n){var t=S++;return n?n+t:t},A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},A.template=function(n,t){var r=A.templateSettings,e="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+n.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(r.escape,function(n,t){return"',_.escape("+t.replace(/\\'/g,"'")+"),'"}).replace(r.interpolate,function(n,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(r.evaluate||null,function(n,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",u=new Function("obj","_",e);return t?u(t,A):function(n){return u.call(this,n,A)}};var F=function(n){this._wrapped=n};A.prototype=F.prototype;var R=function(n,t){return t?A(n).chain():n},k=function(n,t){F.prototype[n]=function(){var n=c.call(arguments);return l.call(n,this._wrapped),R(t.apply(A,n),this._chain)}};A.mixin(A),E(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=u[n];F.prototype[n]=function(){return t.apply(this._wrapped,arguments),R(this._wrapped,this._chain)}}),E(["concat","join","slice"],function(n){var t=u[n];F.prototype[n]=function(){return R(t.apply(this._wrapped,arguments),this._chain)}}),F.prototype.chain=function(){return this._chain=!0,this},F.prototype.value=function(){return this._wrapped}}).call(this);
!function(t){function e(e,a,r){var o=this;return this.on("click.pjax",e,function(e){var i=t.extend({},f(a,r));i.container||(i.container=t(this).attr("data-pjax")||o),n(e,i)})}function n(e,n,a){a=f(n,a);var o=e.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||location.protocol!==o.protocol||location.host!==o.host||o.hash&&o.href.replace(o.hash,"")===location.href.replace(location.hash,"")||o.href===location.href+"#")){var i={url:o.href,container:t(o).attr("data-pjax"),target:o,fragment:null},s=t.extend({},i,a),l=t.Event("pjax:click");t(o).trigger(l,[s]),l.isDefaultPrevented()||(r(s),e.preventDefault())}}function a(e,n,a){a=f(n,a);var o=e.currentTarget;if("FORM"!==o.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var i={type:o.method.toUpperCase(),url:o.action,data:t(o).serializeArray(),container:t(o).attr("data-pjax"),target:o,fragment:null};r(t.extend({},i,a)),e.preventDefault()}function r(e){function n(e,n){var r=t.Event(e,{relatedTarget:a});return s.trigger(r,n),!r.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,r.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var a=e.target,o=p(e.url).hash,s=e.context=d(e.container);e.data||(e.data={}),e.data._pjax=s.selector;var l;e.beforeSend=function(t,a){return"GET"!==a.type&&(a.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",s.selector),n("pjax:beforeSend",[t,a])?(a.timeout>0&&(l=setTimeout(function(){n("pjax:timeout",[t,e])&&t.abort("timeout")},a.timeout),a.timeout=0),void(e.requestUrl=p(a.url).href)):!1},e.complete=function(t,a){l&&clearTimeout(l),n("pjax:complete",[t,a,e]),n("pjax:end",[t,e])},e.error=function(t,a,r){var o=x("",t,e),s=n("pjax:error",[t,a,r,e]);"GET"==e.type&&"abort"!==a&&s&&i(o.url)},e.success=function(a,l,u){var f="function"==typeof t.pjax.defaults.version?t.pjax.defaults.version():t.pjax.defaults.version,d=u.getResponseHeader("X-Build-Info"),h=x(a,u,e);if(f&&d&&f!==d)return void i(h.url);if(!h.contents)return void i(h.url);if(r.state={id:e.id||c(),url:h.url,title:h.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},(e.push||e.replace)&&window.history.replaceState(r.state,h.title,h.url),h.title&&(document.title=h.title),s.html(TAPP.utils.emojify(h.contents)),window.refresh_page_context(),"number"==typeof e.scrollTo&&t(window).scrollTop(e.scrollTo),(e.replace||e.push)&&window._gaq&&_gaq.push(["_trackPageview"]),""!==o){var m=p(h.url);m.hash=o,r.state.url=m.href,window.history.replaceState(r.state,h.title,m.href);var v=t(m.hash);v.length&&t(window).scrollTop(v.offset().top)}n("pjax:success",[a,l,u,e])},r.state||(r.state={id:c(),url:window.location.href,title:document.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},window.history.replaceState(r.state,document.title));var f=r.xhr;f&&f.readyState<4&&(f.onreadystatechange=t.noop,f.abort()),r.options=e;var f=r.xhr=t.ajax(e);return f.readyState>0&&(e.push&&!e.replace&&(v(r.state.id,s.clone().contents(),pjax_context),window.history.pushState(null,"",u(e.requestUrl))),n("pjax:start",[f,e]),r.popstate=!1,n("pjax:send",[f,e])),r.xhr}function o(e,n){var a={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return r(t.extend(a,f(e,n)))}function i(t){window.history.replaceState(null,"","#"),window.location.replace(t)}function s(e){var n=e.state;if(n&&n.container){var a=t(n.container);if(a.length){var o,s=S[n.id];r.state&&(o=r.state.id<n.id?"forward":"back",j(o,r.state.id,a.clone().contents(),pjax_context));var l=t.Event("pjax:popstate",{state:n,direction:o});a.trigger(l);var c={id:n.id,url:n.url,container:a,push:!1,fragment:n.fragment,timeout:n.timeout,scrollTo:!1,success:function(){t.publish("pjax-popstate",[n])}},u=s&&s.value;u?(a.trigger("pjax:start",[null,c]),r.popstate=!0,n.title&&(document.title=n.title),a.html(u),r.state=n,window.refresh_page_context(s.context),a.trigger("pjax:end",[null,c])):r(c),a[0].offsetHeight}else i(location.href)}b=!1}function l(e){var n=t.isFunction(e.url)?e.url():e.url,a=e.type?e.type.toUpperCase():"GET",r=t("<form>",{method:"GET"===a?"GET":"POST",action:n,style:"display:none"});"GET"!==a&&"POST"!==a&&r.append(t("<input>",{type:"hidden",name:"_method",value:a.toLowerCase()}));var o=e.data;if("string"==typeof o)t.each(o.split("&"),function(e,n){var a=n.split("=");r.append(t("<input>",{type:"hidden",name:a[0],value:a[1]}))});else if("object"==typeof o)for(key in o)r.append(t("<input>",{type:"hidden",name:key,value:o[key]}));t(document.body).append(r),r.submit()}function c(){return(new Date).getTime()}function u(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function p(t){var e=document.createElement("a");return e.href=t,e}function f(e,n){return e&&n?n.container=e:n=t.isPlainObject(e)?e:{container:e},n.container&&(n.container=d(n.container)),n}function d(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}function h(t,e){return t.filter(e).add(t.find(e))}function m(e){return t.parseHTML(e,document,!0)}function x(e,n,a){var r={};if(r.url=u(n.getResponseHeader("X-PJAX-URL")||a.requestUrl),/<html/i.test(e))var o=t(m(e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),i=t(m(e.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var o=i=t(m(e));if(0===i.length)return r;if(r.title=h(o,"title").last().text(),a.fragment){if("body"===a.fragment)var s=i;else var s=h(i,a.fragment).first();s.length&&(r.contents=s.contents(),r.title||(r.title=s.attr("title")||s.data("title")))}else/<html/i.test(e)||(r.contents=i);return r.contents&&(r.contents=r.contents.not(function(){return t(this).is("title")}),r.contents.find("title").remove(),r.scripts=h(r.contents,"script[src]").remove(),r.contents=r.contents.not(r.scripts)),r.title&&(r.title=t.trim(r.title)),r}function v(t,e,n){for(S[t]={value:e,context:n},_.push(t);P.length;)delete S[P.shift()];for(;_.length>r.defaults.maxCacheLength;)delete S[_.shift()]}function j(t,e,n,a){var r,o;S[e]={value:n,context:a},"forward"===t?(r=_,o=P):(r=P,o=_),r.push(e),(e=o.pop())&&delete S[e]}function g(){return t("meta").filter(function(){var e=t(this).attr("http-equiv");return e&&"X-PJAX-VERSION"===e.toUpperCase()}).attr("content")}function w(){t.fn.pjax=e,t.pjax=r,t.pjax.enable=t.noop,t.pjax.disable=y,t.pjax.click=n,t.pjax.submit=a,t.pjax.reload=o,t.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:g},t(window).bind("popstate.pjax",s)}function y(){t.fn.pjax=function(){return this},t.pjax=l,t.pjax.enable=w,t.pjax.disable=t.noop,t.pjax.click=t.noop,t.pjax.submit=t.noop,t.pjax.reload=function(){window.location.reload()},t(window).unbind("popstate.pjax",s)}var b=!0,T=(window.location.href,window.history.state);T&&T.container&&(r.state=T);var S={},P=[],_=[];t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),t.support.pjax?w():y()}(jQuery);
!function(e,i){"use strict";var t="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(a){function n(){var i=e(l),t=e(g);s&&(g.length?s.reject(A,i,t):s.resolve(A)),e.isFunction(a)&&a.call(d,A,i,t)}function r(e){o(e.target,"error"===e.type)}function o(i,a){i.src!==t&&-1===e.inArray(i,u)&&(u.push(i),a?g.push(i):l.push(i),e.data(i,"imagesLoaded",{isBroken:a,src:i.src}),c&&s.notifyWith(e(i),[a,A,e(l),e(g)]),A.length===u.length&&(setTimeout(n),A.unbind(".imagesLoaded",r)))}var d=this,s=e.isFunction(e.Deferred)?e.Deferred():0,c=e.isFunction(s.notify),A=d.find("img").add(d.filter("img")),u=[],l=[],g=[];return e.isPlainObject(a)&&e.each(a,function(e,i){"callback"===e?a=i:s&&s[e](i)}),A.length?A.bind("load.imagesLoaded error.imagesLoaded",r).each(function(a,n){var r=n.src,d=e.data(n,"imagesLoaded");return d&&d.src===r?void o(n,d.isBroken):n.complete&&n.naturalWidth!==i?void o(n,0===n.naturalWidth||0===n.naturalHeight):void((n.readyState||n.complete)&&(n.src=t,n.src=r))}):n(),s?s.promise(d):d}}(jQuery);
$(document).ajaxSend(function(t,e,n){function o(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var c=jQuery.trim(n[o]);if(c.substring(0,t.length+1)===t+"="){e=decodeURIComponent(c.substring(t.length+1));break}}return e}function c(t){var e=document.location.host,n=document.location.protocol,o="//"+e,c=n+o;return t===c||t.slice(0,c.length+1)===c+"/"||t===o||t.slice(0,o.length+1)===o+"/"||!/^(\/\/|http:|https:)/.test(t)}function r(t){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(t)}!r(n.type)&&c(n.url)&&e.setRequestHeader("X-CSRFToken",o("csrftoken"))});
!function(){window.TAPP&&window.TAPP.initialized||(window.TAPP=window.TAPP||{},window.TAPP.initialized=!0,function(){var n,e;jQuery.uaMatch=function(n){n=n.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:e[1]||"",version:e[2]||"0"}},n=jQuery.uaMatch(navigator.userAgent),e={},n.browser&&(e[n.browser]=!0,e.version=n.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),jQuery.browser=e,jQuery.sub=function(){function n(e,t){return new n.fn.init(e,t)}jQuery.extend(!0,n,this),n.superclass=this,n.fn=n.prototype=this(),n.fn.constructor=n,n.sub=this.sub,n.fn.init=function(t,o){return o&&o instanceof jQuery&&!(o instanceof n)&&(o=n(o)),jQuery.fn.init.call(this,t,o,e)},n.fn.init.prototype=n.fn;var e=n(document);return n}}(),"undefined"==typeof window.console&&(window.console={log:function(){return!0}}),$._ajax=$.ajax,$.ajax=function(n,e){var t=n.success;return n.success=function(n,e,o){var i=n&&n.result?n.result:null,r=n&&n.value?n.value:"ajax failed",a=n&&n.text?n.text:"ajax failed";return i&&"ok"!==i?void(this.error&&this.error(o,r,a)):void(t&&t.apply(this,[n,e,o]))},$._ajax(n,e)},function(){var n=function(){var n=-1;if("Microsoft Internet Explorer"===navigator.appName){var e=navigator.userAgent,t=/MSIE ([0-9]{1,}[\.0-9]{0,})/;null!==t.exec(e)&&(n=parseFloat(RegExp.$1))}return n},e=n();-1!==e&&(e=(""+e).replace(/\./g,"_"),$("html").addClass("ie v"+e+"_0"))}(),window.refresh_page_context=function(n){var e=document.getElementById("adn-page-context");if(e){var t=e.getAttribute("data-adn-page-context");window.page_context=JSON.parse(t)}window.pjax_context=n||{}},window.refresh_page_context(),function(){var n=[],e=[],t=[];$.fn.tapp_on=function(e,t,o,i){return n.push([this,e,t]),this.on(e,t,o,i)},$.tapp_subscribe=function(n,t){var o=$.subscribe(n,t);return e.push(o),o},TAPP.setInterval=function(n,e){var o=setInterval(n,e);return t.push(o),o},TAPP.clearInterval=function(n){$.map(t,function(e){return n===e?null:e})},TAPP.clear_event_handles=function(){$.each(n,function(n,e){$(e[0]).off(e[1],e[2])})},TAPP.clear_subscribe_handles=function(){$.each(e,function(n,e){$.unsubscribe(e)})},TAPP.clear_intervals=function(){$.each(t,function(){clearInterval(this)})},TAPP.unload=function(){TAPP.clear_event_handles(),TAPP.clear_subscribe_handles(),TAPP.clear_intervals()},TAPP.lock_up=function(n,e){e=e||"click";{var t=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on(e,t)}return function(){setTimeout(function(){n.off(e,t)},0)}},TAPP.register_post_load_hooks=function(n,e){$.each(n,function(n,t){$.subscribe(n,$.proxy(t,e))})},TAPP.conditional_bindings=function(){var n=[],e=function(e,t){n.push([e,t])},t=function(){return n};return{add:e,all:t}}()}(),function(){$.waitForFuncs=function(n,e,t){var o=[];$.each(n,function(n,t){var i=$.Deferred();o.push(i),t.push(function(){i.resolve()}),e.apply(this,t)}),$.when.apply(this,o).done(t)}}(),$(document).ajaxSend(function(n,e,t){"POST"===t.type&&e.setRequestHeader("Cache-Control","no-cache")}),TAPP.FB_INIT_DEFERRED=$.Deferred(),$(document).ready(function(){var n=function(){var n=page_context.page_load_hooks;n&&($.isArray(page_context.page_load_hooks)||(n=[n]),$.each(page_context.page_load_hooks,function(n,e){if(-1!==e.indexOf(".")){var t,o=e.split("."),i=TAPP;$.each(o,function(n,e){t=i,i=i[e]}),$.isFunction(i)&&i.call(t)}else $.publish(e)})),$.publish("js_init_done")};n(),$(window).on("pjax:start",function(){TAPP.unload(),$.each(TAPP,function(){this&&this.unload&&this.unload()})}),$(window).on("pjax:end",function(){n()})}))}();
!function(){var e=document.documentElement,t=window.TAPP_MEDIA_QUERIES={phone:"(max-width: 700px)",tablet:"(min-width: 701px) and (max-width: 1151px)",widescreen:"(min-width: 1152px)",retina:"only screen and (-webkit-min-device-pixel-ratio : 2)",height_large:"(min-height: 1200px)",height_medium:"(min-height: 950px) and (max-height: 1199px)",height_small:"(min-height: 600px) and (max-height: 949px)",height_mini:"(max-height: 599px)",height_extra_mini:"(max-height: 320px)"},i=function(e){return function(){return Modernizr.mq(e)}};e.className=e.className.replace("breakpoint-phone",""),Modernizr.test_media_queries=function(){for(var e in t)Modernizr.addTest("breakpoint-"+e,i(t[e]))},Modernizr.test_media_queries(),Modernizr.test_checked_selector=function(){Modernizr.addTest("checked",function(){return Modernizr.testStyles("#modernizr input {width:100px} #modernizr :checked {width:200px;display:block}",function(e){var t=document.createElement("input");return t.setAttribute("type","checkbox"),t.setAttribute("checked","checked"),e.appendChild(t),200===t.offsetWidth})})},Modernizr.test_checked_selector()}();
!function(){var t=Array.prototype,o=(Object.prototype,Function.prototype,t.slice),r=function(){},n=function(t){return $.each(o.call(arguments,1),function(o,r){var n;for(n in r)void 0!==r[n]&&(t[n]=r[n])}),t},e=function(t,o,e){var p;return p=o&&o.hasOwnProperty("constructor")?o.constructor:function(){return t.apply(this,arguments)},n(p,t),r.prototype=t.prototype,p.prototype=new r,o&&n(p.prototype,o),e&&n(p,e),p.prototype.constructor=p,p.__super__=t.prototype,p},p=function(t,o){var r=e(this,t,o);return r.extend=this.extend,r},c=function(){};c.extend=p,TAPP.Klass=c}();
window.APPDOTNET=function(){var t={api_base_url:"https://api.app.net/",enabled_migrations:["disable_min_max_id","response_envelope","follow_pagination","pagination_ids"]},e={init:function(e){if(this.options=$.extend({},t,e),this.options.root_url=this.options.api_base_url,this.options.no_globals)try{delete window.APPDOTNET}catch(s){}return this},request:function(t,e){e.url=this.options.root_url+t;var s={};if(this.options.enabled_migrations){var r=$.map(this.options.enabled_migrations,function(t){return t+"=1"});s["X-ADN-Migration-Overrides"]=r.join("&")}return this.options.avt&&(s["X-AVT"]=this.options.avt),e.beforeSend=function(t){_.each(s,function(e,s){t.setRequestHeader(s,e)})},$.ajax(e)},convert_to_json:function(t){return t.contentType="application/json",t.dataType="json",t.data=JSON.stringify(t.data),t},post:function(t){var e={type:"POST",data:t};return this.request("posts?include_post_annotations=1",this.convert_to_json(e))},follow:function(t,e){var s={data:{user_id:t}};if(1===e)s.type="POST";else{if(0!==e)throw"Invalid follow state.";s.type="DELETE"}return this.request("users/"+t+"/follow",s)},delete_post:function(t){var e={type:"DELETE"},s="posts/"+t;return this.request(s,e)},report_post:function(t,e){var s={type:"POST",data:{reason:e}};return this.request("posts/"+t+"/report",this.convert_to_json(s))},mute_user:function(t){var e={type:"POST"},s="users/"+t+"/mute";return this.request(s,e)},unmute_user:function(t){var e={type:"DELETE"},s="users/"+t+"/mute";return this.request(s,e)},block_user:function(t){var e={type:"POST"},s="users/"+t+"/block";return this.request(s,e)},unblock_user:function(t){var e={type:"DELETE"},s="users/"+t+"/block";return this.request(s,e)},star_post:function(t,e){var s={};if(1===e)s.type="POST";else{if(0!==e)throw"Invalid star state.";s.type="DELETE"}return this.request("posts/"+t+"/star",s)},repost_post:function(t,e){var s={};if(1===e)s.type="POST";else{if(0!==e)throw"Invalid repost state.";s.type="DELETE"}return this.request("posts/"+t+"/repost",s)},update_stream_marker:function(t,e){var s={type:"POST",data:{name:t,id:e}};return this.request("posts/marker",this.convert_to_json(s))},text_process:function(t){var e={type:"POST",data:{text:t}};return this.request("text/process",this.convert_to_json(e))},file_create:function(t,e){var s={type:"POST",data:t,cache:!1,contentType:!1,processData:!1,progress:e};return this.request("files",s)},file_delete:function(t,e){var s={type:"DELETE"},r="";e&&(r="?"+jQuery.param({file_token:e}));var n="files/"+t+r;return this.request(n,s)},subscribe_channel:function(t,e){var s={};if(1===e)s.type="POST";else{if(0!==e)throw"Invalid subscribe state.";s.type="DELETE"}var r="channels/"+t+"/subscribe";return this.request(r,s)},recommend_app:function(t,e){var s={};if(1===e)s.type="POST";else{if(0!==e)throw"Invalid recommend state.";s.type="DELETE"}var r="directory/apps/"+t+"/recommend";return this.request(r,s)},create_message:function(t,e){var s={type:"POST",data:e},r="channels/"+t+"/messages?include_annotations=1";return this.request(r,this.convert_to_json(s))}};return TAPP.appdotnet_api=e.init(page_context.api_options),e}();
!function(){var n=$.Deferred();$(window).on("load",function(){n.resolve()}),$.fn.serializeObject=function(n){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(void 0===this.value?"":this.value)):t[this.name]=void 0===this.value?"":this.value,n&&("on"===t[this.name]&&(t[this.name]=1),"off"===t[this.name]&&(t[this.name]=0))}),t},$.fn.affix=function(){var n=$(window),t=[],e=n.scrollTop(),i=function(n){var t="true"===n.el.attr("data-is-stuck"),i=e<=n.start_top-n.offset;t&&i&&(n.el.removeClass("stuck"),n.el.attr("data-is-stuck","false")),t||i||(n.el.addClass("stuck"),n.el.attr("data-is-stuck","true"))},r=function(){e=n.scrollTop(),_.each(t,i)},o=!1,a=function(){n.on("scroll.affix",_.debounce(r,10)),o=!0},s=function(n){var e=$(this);if(!e.length)return this;var i=e.attr("data-start-offset-top");return"undefined"==typeof i&&(i=e.offset().top,e.attr("data-start-offset-top",i)),i=parseInt(i,10),o||a(),t.push({offset:n,el:e,start_top:i}),this};return s.unload=function(){t=[],e=n.scrollTop(),n.off("scroll.affix"),o=!1},s}(),_.mixin({chunks:function(n,t){var e=_.groupBy(n,function(n,e){return Math.floor(e/t)});return e=_.toArray(e)}}),TAPP.utils={intcomma:function(n){return n=""+n,n.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},show_form_errors:function(n,t){$.each(t,function(t,e){var i=n.find(".field-"+t);i.addClass("bad");var r=i.find("input,textarea");r.addClass("bad");var o="";$.each(e,function(n,t){o+="<li>"+t+"</li>"});var a=i.find("ul.error");a.length||(r.after('<ul class="error"></ul>'),a=i.find("ul.error")),a.html(o)})},show_new_form_errors:function(n,t){$.each(t,function(t,e){var i=n.find(".field-"+t);i.addClass("error");var r=i.find("input,textarea"),o="";$.each(e,function(n,t){o+="<li>"+t+"</li>"});var a=i.find("ul.help-inline");a.length||(r.after('<ul class="help-inline"></ul>'),a=i.find("ul.help-inline")),a.html(o)})},clear_form_errors:function(n){n.find(".field").each(function(){var n=$(this);n.removeClass("error"),n.find(".help-inline").remove()})},is_touch:function(){return $("html").hasClass("touch")},is_widescreen:function(){return $("html").hasClass("breakpoint-widescreen")},is_phone:function(){return $("html").hasClass("breakpoint-phone")},handle_resize:function(){$(window).on("resize",_.debounce(Modernizr.test_media_queries,50))},on_window_load:function(t){n.done(t)},fit_to_box:function(n,t,e,i,r){if(r=r||!1,e>n&&i>t&&!r)return[n,t];var o=Math.max(n/e,t/i),a=parseInt(t/o,10),s=parseInt(n/o,10);return[s,a]},autofocus_polyfill:function(){Modernizr.input.autofocus||$("input[autofocus]").first().focus()},emojify:function(n){if(window.OSEmoji){var t=$("<div/>").append(n).get(0);return window.OSEmoji.run(t),$(t.childNodes)}return n}}}(TAPP);
!function(){var a={backdrop:!1,zIndex:1e4,buttons:{Close:function(){$(this).modal("close")}}},t=function(a,t,o){a=$("<div/>").addClass("modal-header").html(a),t=$("<div/>").addClass("modal-body").html(t),o=$("<div/>").addClass("modal-footer btn-group-spaced").html(o);var n=$("<div/>").addClass("modal").append(a).append(t).append(o);return n.addClass("hide").appendTo($("body")),$(n)},o=function(a){if(!a)return null;var t=$("<div/>");return $.each(a,function(a,o){var n=o.text||a,e=o["class"]||"btn btn-small",l=o.attrs||{},i=o.data||{},d=o.click||$.noop(),r=o.html,s=$("<button/>").text(n).addClass(e).on("click",d).data(i);r&&s.html(r),$.each(l,function(a,t){s.attr(a,t)}),t.append(s)}),t},n=function(n,e){"string"!=typeof n&&(n=n.html());var l=e.title||"",i=e.buttons?o(e.buttons):e.footer||"",d=$.extend({},a,e),r=t(l,n,i);return r.addClass(d.modal_classes),r.modal(d),r};TAPP.dialogs={markup_dialog:function(a,t){return n(a,t)},error_dialog:function(a,t,o){var e;a=a||"Something is wrong with the server. Please wait a moment and try again.";var l=$.extend({},{title:"<h3>An error occurred<h3>",modal_classes:"error-dialog",buttons:{Ok:{click:function(){e.modal("hide"),e.remove(),t&&t()}}}},o);return e=n(a,l),e.modal("show"),e},confirm_dialog:function(a,t,o,e,l,i){e=e||"<h3>Are you sure?</h3>",l=(l||"")+" confirmation-dialog";var d=$(a),r=function(a){a.preventDefault(),a.stopImmediatePropagation();var d,r=$(this),s=i||{Cancel:{click:function(){d.modal("hide")},"class":"btn btn-small"},Continue:{click:function(){r.unbind(a),r.trigger($.Event(t)),d.modal("hide")},text:"Continue","class":"btn btn-primary btn-small"}};if(r.data("dialog-init"))d=r.data("dialog-init");else{var c={title:"<h3>"+e+"</h3>",modal_classes:l,buttons:s};d=n(o,c),r.data("dialog-init",d)}return d.modal("show"),!1};d.bind(t,r)},deferred_confirm_dialog:function(a,t,o,e){var l=$.Deferred();t=t||"<h3>Are you sure?</h3>",o=(o||"")+" confirmation-dialog";var i,d=e||{Cancel:{click:function(){i.modal("hide"),i.remove(),l.reject()},"class":"btn btn-small"},Continue:{click:function(){i.modal("hide"),i.remove(),l.resolve()},text:"Continue","class":"btn btn-primary btn-small"}},r={title:"<h3>"+t+"</h3>",modal_classes:o,buttons:d};return i=n(a,r),i.modal("show"),l.promise()},upgrade_dialog:function(a,t,o){t="<h3>"+(t||"Upgrade To Get More")+"</h3>";var e,l=function(){e.modal("hide"),e.remove()},i={title:t,modal_classes:"upgrade-dialog",backdrop:!0,buttons:{Close:{click:l,"class":"pull-left btn"},Upgrade:{click:function(){l(),o()},"class":"btn btn-success"}}},d="<p>"+a+"</p>";return e=n(d,i)}},TAPP.register_post_load_hooks({confirm_dialog:TAPP.dialogs.confirm_dialog,error_dialog:TAPP.dialogs.error_dialog},TAPP.dialogs)}();
!function(){var e=[];TAPP.event_tracking={fire_off_event:function(e,t,n){if(!page_context.disable_mixpanel&&window.mixpanel){var a,i=function(){clearTimeout(a),n&&n()};t.user_id&&mixpanel.name_tag(t.user_id),mixpanel.track(e,t,function(){i()}),n&&(a=setTimeout(n,300)),page_context.console_log_mixpanel&&console.log(e+", "+JSON.stringify(t))}},mixpanel_process_event_queue:function(t){var n=function(){e=[],t()};$.waitForFuncs(e,TAPP.event_tracking.fire_off_event,n)},mixpanel_empty_event_queue:function(){e=[]},mixpanel_global_metadata:function(){var e={omo_user_id:page_context.omo_user_id,href:window.location.href};e.distinct_id=page_context.omo_user_id?page_context.omo_user_id:page_context.cookie_value,page_context.mixpanel_data&&$.extend(e,page_context.mixpanel_data);var t={};return _.each(e,function(e,n){"undefined"!=typeof e&&(t[n]=e)}),t},track_event:function(e,t,n){var a=this.mixpanel_global_metadata();return t&&$.extend(a,t),this.fire_off_event(e,a,n)},track_event_server_side:function(e,t,n){var a={action:"receive_event",event_name:e};t&&$.extend(a,t);var i={type:"POST",url:""+window.location,data:a};return n&&(i.timeout=n),$.ajax(i)},track_from_html_attr:function(){$("body").on("click","[data-track-click]",function(){var e=$(this),t=e.attr("href"),n=e.data("track-click"),a=e.data("track-properties"),i=e.data("track-server-side");return i?TAPP.event_tracking.track_event_server_side(n,a,300).always(function(){t&&(window.location.href=t)}):TAPP.event_tracking.track_event(n,a,function(){t&&(window.location.href=t)}),!1}),$("[data-track-seen]").each(function(e,t){var n=$(t),a=n.data("track-seen"),i=n.data("track-properties");TAPP.event_tracking.track_event(a,i)})}},TAPP.register_post_load_hooks({track_event:TAPP.event_tracking.track_event,track_from_html_attr:TAPP.event_tracking.track_from_html},TAPP.event_tracking),TAPP.conditional_bindings.add("[data-track-click]",function(){TAPP.event_tracking.track_from_html_attr()})}();
!function(){!function(t){var e=t.ajaxSettings.xhr;t.ajaxSetup({progress:t.noop,xhr:function(){var t=e(),i=this;return t&&t.upload&&"function"==typeof t.upload.addEventListener&&t.upload.addEventListener("progress",function(t){i.progress(t)},!1),t}})}(jQuery);var t=function(t){this.activator=t.activator,this.file_input=t.file_input,this.on_file=t.on_file||$.noop,this.on_file_reset=t.on_file_reset||$.noop,this.on_upload_start=t.on_upload_start||$.noop,this.on_progress=t.on_progress||$.noop,this.on_upload_done=t.on_upload_done||$.noop,this.allow=t.allow||!1,this.on_disallow=t.on_disallow||$.noop,this.max_file_size=t.max_file_size||!1,this.upload_to=t.upload_to,this.extra_data=t.extra_data||[],this.upload_on_change=t.upload_on_change||!1,this.validator=t.validator||$.noop,this.upload_state=$.Deferred()};$.extend(t.prototype,{handle_change:function(t){var e=t.target.files&&t.target.files.length?t.target.files[0]:!1;if(!t.target.files&&!e){var i=$(t.target),o=i.closest("form");return void o.get(0).submit()}if(e){if(this.allow&&!this.allow.test(e.type))return void this.on_disallow(e);if(this.max_file_size&&this.max_file_size<e.size){var a=this.max_file_size/1024/1024,s=Math.round(e.size/1024/1024*100)/100;return void TAPP.dialogs.error_dialog("The max file size is "+a+"MB. The file you tried to attach was "+s+"MB")}this.file=e,this.on_file(e,function(){var t=new FileReader,i=$.Deferred();return t.onload=function(t){i.resolve(t)},t.readAsDataURL(e),i}),this.upload_on_change&&this.upload_file()}},handle_activator_click:function(){return this.file_input.trigger("click"),!1},bind_events:function(){this.activator.tapp_on("click.uploader",$.proxy(this.handle_activator_click,this)),this.bind_file_events()},bind_file_events:function(){this.file_input.tapp_on("change.uploader",$.proxy(this.handle_change,this))},reset_file_upload:function(){this.upload_state=$.Deferred(),this.file_input.off("change.uploader"),this.file_input.replaceWith(this.file_input.val("").clone(!0)),this.bind_file_events(),this.on_file_reset()},upload_file:function(){this.on_upload_start();var t=new FormData;t.append("content",this.file),_.map(this.extra_data,function(e){t.append(e[0],e[1])}),this.current_upload=this.upload_to(t,$.proxy(function(t){if(t.lengthComputable){var e=parseInt(t.loaded/t.total*100,10);this.on_progress(e)}},this)),this.current_upload.fail($.proxy(function(t){var e;try{e=JSON.parse(t.responseText)}catch(i){e={}}if(e&&507===t.status){var o="file-size"===e.meta.error_slug?"Oops! This file is too large":"Wow! You have used up your file storage allotment";TAPP.dialogs.upgrade_dialog(e.meta.error_message,o,function(){window.location=page_context.upgrade_storage_url})}else e&&400===t.status?TAPP.dialogs.error_dialog(e.meta.error_message):TAPP.dialogs.error_dialog();this.upload_state.reject(),this.reset_file_upload()},this)),this.current_upload.done($.proxy(function(t){var e=this.validator===$.noop||this.validator(t);e?(this.upload_state.resolve(t),this.on_upload_done(t)):(this.upload_state.reject(),this.reset_file_upload())},this))},update_progress:function(t){this.on_progress(t)}}),window.TAPP.FileUploader=t;var e=function(t,e){this.container=t||$("body"),this.init(e||{})};$.extend(e.prototype,{init:function(t){var e=this.activator=this.container.find("[data-attach-btn]"),i=this.container.find("[data-file-upload-input]"),o=this.container.find("[data-image-preview-container]");this.name_preview=o.find("[data-img-name]"),this.upload_progress_cont=o.find("[data-upload-progress]"),this.upload_progress_bar=this.upload_progress_cont.find(".bar"),this.remove_file=o.find("[data-remove-attachment]");var a={activator:e,file_input:i,on_file:$.proxy(this.on_file,this),on_file_reset:$.proxy(this.on_file_reset,this),on_upload_start:$.proxy(this.on_upload_start,this),on_progress:$.proxy(this.on_progress,this),on_upload_done:$.proxy(this.on_upload_done,this),on_disallow:$.proxy(this.on_disallow,this),upload_on_change:!0,upload_to:$.proxy(TAPP.appdotnet_api.file_create,TAPP.appdotnet_api),current_file_id:null,current_file_token:null,delete_on_removal:!0,extra_data:[["type","net.app.alpha.attachment"]],allow:/image\/(gif|png|jpeg)/},s=$.extend({},a,t);this.uploader=new TAPP.FileUploader(s),this.current_file_id=s.current_file_id,this.current_file_token=s.current_file_token,this.uploader.bind_events(),this.remove_file.on("click",$.proxy(function(){s.delete_on_removal&&TAPP.appdotnet_api.file_delete(this.current_file_id,this.current_file_token),this.uploader.reset_file_upload()},this))},on_disallow:function(){TAPP.dialogs.error_dialog("You can only attach images. The file you tried to attach was not an image.")},on_file:function(t,e){this.file=t,this.container.trigger("file",[t,e]),this.upload_progress_cont.removeClass("hide"),this.name_preview.find("[data-text]").text(t.name)},on_file_reset:function(){this.current_file_id=null,this.file=null,this.container.trigger("file_reset"),this.name_preview.find("[data-text]").text("").removeClass("text-success"),this.upload_progress_cont.addClass("hide").removeClass("plain"),this.upload_progress_bar.css("width","0%").removeClass("hide"),this.remove_file.addClass("hide"),this.activator.removeClass("hide")},on_upload_start:function(){this.upload_progress_cont.removeClass("hide"),this.upload_progress_bar.css("width","0%"),this.activator.addClass("hide"),this.container.trigger("upload_start")},on_progress:function(t){t=Math.max(t,5),this.upload_progress_bar.css("width",t+"%"),this.container.trigger("progress",[t])},on_upload_done:function(t){this.current_file_id=t.data.id,this.current_file_token=t.data.file_token,this.upload_progress_cont.addClass("plain"),this.upload_progress_bar.addClass("hide"),this.remove_file.removeClass("hide"),this.name_preview.find("[data-text]").addClass("text-success"),this.container.trigger("upload_done",[t])}}),window.TAPP.FileUploadWidget=e}();
!function(){var t={init:function(){var t=$("[data-search-bar-form]"),e=t.find("input.search-bar-input");0!==e.length&&(e.typeahead([{name:"universal",template:function(t){return t.html},remote:{url:page_context.autocomplete_url+"?q=%QUERY",filter:function(t){return t.response},dataType:"jsonp"}}]),e.tapp_on("typeahead:selected",function(t,e){void 0!==e.search&&$.ajax({url:page_context.search_log_url,dataType:"jsonp",data:{"search-data":e.search}}),window.setTimeout(function(){window.location=e.url},50)}),e.tapp_on("typeahead:autocomplete",function(){t.submit()}),e.tapp_on("keypress",function(e){13===e.which&&t.get(0).submit()}),t.find('[type="submit"]').tapp_on("click",function(){t.get(0).submit()}))}};TAPP.autocomplete=t}();
!function(){var t=($.extend({},page_context.api_options,{no_globals:!0}),{container:"#pjax-container",push:!0,timeout:1e4});$.pjax&&$.pjax.defaults&&($.pjax.defaults.version=page_context.build_info),$(window).on("resize",_.debounce(Modernizr.test_media_queries,50)),TAPP.pau={init_pau:function(){this.intercept_links(),TAPP.utils.handle_resize(),this.search_bar(),$("meta[name=viewport]").attr("content","width=device-width, initial-scale=1, maximum-scale=1")},unload:function(){$.fn.affix.unload()},init_fixed_nav:function(){var t=$(".sidebar-fixed-part"),a=parseInt(t.data("fixed-offset"),10);t.affix(a),$(".create-an-account").affix(0)},init_placeholder:function(){$("input[placeholder], textarea[placeholder]").placeholder()},search_bar:function(){$("body").tapp_on("submit","[data-search-bar-form]",function(){var t=$(this).closest("[data-search-bar-form]").find('input[type="text"]');return $.trim(t.val())?void 0:!1})},intercept_links:function(){var t=this;$("body").tapp_on("click.intercept_links","a",function(a){var e=$(this),o=e.attr("href"),r=e.data("pjax-url"),n=e.get(0);if(r){o=r;var s=document.createElement("a");s.href=o,n=s}return location.host!==n.host?!0:a.which>1||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey?!0:!o||e.attr("target")||"#"===o.substring(0,1)||"javascript:"===o.substring(0,11)||e.data("non-pjax")?void 0:t.pjax_load_page({url:o})})},pjax_load_page:function(a){var e=$.extend({},t,a);return $.pjax(e),!1},scroll_to:function(t){var a=60,e=$.Deferred();return $.pjax.scrolling?(e.resolve(),e):(TAPP.utils.on_window_load(function(){$("html, body").animate({scrollTop:t.offset().top-a},50,function(){e.resolve()})}),e)},get_post_el_from_id:function(t){var a=$("[data-post-parent-id="+t+"]"),e=$("[name="+t+"]");return e=a.length?a:e},scroll_post_into_view:function(t,a){var e=this.get_post_el_from_id(t);if(e.length&&!$.pjax.popstate)return a&&e.addClass(a),this.scroll_to(e);var o=$.Deferred();return o.resolve(),o},zoom_to_post:function(){var t=window.location.hash,a=t.substr(1,t.length),e="highlight";return a||(a=page_context.post_id,e=""),this.scroll_post_into_view(a,e)},init_block_user:function(){var t=function(t,a,e,o){var r=TAPP.lock_up(t),n=1===o?0:1,s=0===n?TAPP.appdotnet_api.unblock_user:TAPP.appdotnet_api.block_user,i=$('[data-follow-btn][data-user-id="'+a+'"]'),l=$('[data-post-author-id="'+a+'"]');l.addClass("hide"),$("[data-block-help]").toggleClass("blocked"),t.attr("data-block-status",n).toggleClass("blocked"),s.call(TAPP.appdotnet_api,a).always(r).fail(function(){t.attr("data-block-status",o).toggleClass("blocked"),TAPP.dialogs.error_dialog("We were unable to block "+e+". Wait a moment, and try again"),l.removeClass("hide")}).done(function(){l.remove(),i.each(function(t,a){var e=$(a);1===parseInt(e.attr("data-follow-status"),10)&&TAPP.follow.update_follow_state(e,0,e.closest("[data-follow-details]"))})})};$("body").tapp_on("click","[data-block-user]",function(){var a=$(this),e=parseInt(a.attr("data-block-status"),10),o=a.data("user-id"),r=a.data("username");if(1===e)t(a,o,r,e);else{var n,s={Cancel:{click:function(){return n.remove(),!1}},Block:{click:function(){return t(a,o,r,e),n.remove(),!1},text:"Block","class":"btn btn-small btn-danger"}},i={title:"<strong>Block "+r+"</strong>",buttons:s};n=TAPP.dialogs.markup_dialog("Are you sure you want to block "+r+"? You will no longer be able to follow or interact with each other on App.net.",i),n.show()}return $(".user-preferences-dropdown").dropdown("toggle"),!1})},mute_user:function(t,a,e,o,r){var n=function(t,a,e,o,r){if(r=r&&0===o){var n=$('[data-post-author-id="'+a+'"]');n.addClass("hide")}var s=TAPP.lock_up(t),i=1===o?0:1,l=0===i?TAPP.appdotnet_api.unmute_user:TAPP.appdotnet_api.mute_user;$("[data-mute-help]").toggleClass("muted"),t.attr("data-mute-status",i).toggleClass("muted"),l.call(TAPP.appdotnet_api,a).always(s).fail(function(){t.attr("data-mute-status",o).toggleClass("muted"),r&&n.removeClass("hide"),TAPP.dialogs.error_dialog("We were unable to mute "+e+". Wait a moment, and try again")}).done(function(){r&&n.remove()})};if(1===o)n(t,a,e,o,r);else{var s,i={Cancel:{click:function(){return s.remove(),!1}},Mute:{click:function(){return n(t,a,e,o,r),s.remove(),!1},text:"Mute","class":"btn btn-danger btn-small"}},l={title:"<strong>Mute "+e+"</strong>",buttons:i};s=TAPP.dialogs.markup_dialog("Are you sure you want to mute "+e+"? This action will hide all of their posts from your feeds and block any @mentions that user directs toward you.",l),s.show()}},init_mute_user:function(){$("body").tapp_on("click","[data-mute-user]",function(){var t=$(this),a=parseInt(t.attr("data-mute-status"),10),e=t.data("user-id"),o=t.data("username");return TAPP.pau.mute_user(t,e,o,a,!1),$(".user-preferences-dropdown").dropdown("toggle"),!1})},promote_related_broadcasts_dialog:function(){var t,a=$("[data-promote-related-broadcasts-html]").html(),e=$("[data-promote-related-broadcasts-title]").html(),o=!!$("[data-promote-related-broadcasts-show-download-button]").length,r=$("[data-promote-related-broadcasts-download-url]").data("promote-related-broadcasts-download-url"),n=$("[data-related-broadcasts-user-id]").data("related-broadcasts-user-id"),s={show_download_button:o,creator_id:n},i={title:e,modal_classes:"promote-related-broadcasts"};o&&(i.buttons={"Download the Free App":{click:function(){return t.remove(),TAPP.event_tracking.track_event("cross-promote-broadcast-download-click",s,function(){window.location.href=r}),!1},"class":"btn btn-primary related-broadcasts-button"}}),t=TAPP.dialogs.markup_dialog(a,i),t.show(),TAPP.event_tracking.track_event("cross-promote-broadcast-view",s)},init_promote_related_broadcasts:function(){var t=!!$("[data-promote-related-broadcasts-show-download-button]").length,a=$("[data-related-broadcasts-user-id]").data("related-broadcasts-user-id");$("body").tapp_on("click","[data-promote-related-broadcasts-channels-list] [data-subscribe-btn]",function(){TAPP.event_tracking.track_event("cross-promote-broadcast-subscribe-click",{show_download_button:t,creator_id:a})})},interstitial:function(){var t=window.location.hostname.split(".").slice(-2).join(".");$.cookie("seen_interstitial",page_context.timestamp,{expires:365,path:"/",domain:"."+t})}},TAPP.register_post_load_hooks({init_pau:TAPP.pau.init_pau,init_placeholder:TAPP.pau.init_placeholder,zoom_to_post:TAPP.pau.zoom_to_post},TAPP.pau)}();
!function(){$.fn.setCursorPosition=function(t){return 0===this.length?this:$(this).setSelection(t,t)},$.fn.setSelection=function(t,e){if(0===this.length)return this;var a=this[0];if(a.createTextRange){var s=a.createTextRange();s.collapse(!0),s.moveEnd("character",e),s.moveStart("character",t),s.select()}else a.setSelectionRange&&(a.focus(),a.setSelectionRange(t,e));return this},$.fn.focusEnd=function(){return this.setCursorPosition(this.val().length),this};var t=/\[([^\]]+)\]\((\S+(?=\)))\)/,e=function(e){function a(t,e){return e}var s;do s=e,e=s.replace(t,a);while(e!==s);return e},a=TAPP.Klass.extend({init:function(t,e,a){this.input=t,this.char_counter=$(e),$("html").hasClass("touch")&&this.char_counter.addClass("hide"),this.update_char_count=_.debounce($.proxy(this._update_char_count,this),50),this.initial_char_count=parseInt(this.char_counter.attr("data-total-chars"),10);var s={markdown_support:!1,perma_text:""};a=$.extend({},s,a),this.opts=a,this.input.tapp_on("keyup",this.update_char_count),this.update_char_count()},set_total_chars:function(t){this.char_counter.attr("data-total-chars",t)},reset_char_counter:function(){this.char_counter.attr("data-total-chars",this.initial_char_count)},max_chars:function(){return parseInt(this.char_counter.attr("data-total-chars"),10)},current_chars:function(){return parseInt(this.char_counter.attr("data-current-chars"),10)},chars_left:function(){return parseInt(this.char_counter.attr("data-chars-left"),10)},addClass:function(t){return this.char_counter.addClass(t)},removeClass:function(t){return this.char_counter.removeClass(t)},hasClass:function(t){return this.char_counter.hasClass(t)},_update_char_count:function(){var t=this.input.val();this.opts.perma_text&&(t+=this.opts.perma_text);var a=t;if(this.opts.markdown_support&&(a=e(a)),a){var s=a.length,r=parseInt(this.char_counter.attr("data-total-chars"),10),n=r-s;this.char_counter.attr("data-chars-left",n).text(n),this.char_counter.attr("data-current-chars",s),this.input.trigger("char-count-updated")}}}),s=TAPP.Klass.extend({init:function(){this.success_text=$("[data-success-text]"),this.submit_button=$("[data-submit-button]"),this.init_char_counter(),this.bind_events()},init_char_counter:function(){},events:function(){return[["char-count-updated","[data-message-create] [data-main-message]","update_button_state"],["keydown","[data-message-create] [data-main-message]","check_for_cmd_click"],["click","[data-submit-button]","handle_submit"]]},bind_events:function(){_.each(this.events(),function(t){$("body").tapp_on(t[0],t[1],$.proxy(this[t[2]],this))},this)},timeout:null,show_success_text:function(){this.success_text.removeClass("hide").removeClass("fade"),clearTimeout(this.timeout),this.timeout=setTimeout($.proxy(function(){this.success_text.addClass("fade").addClass("hide")},this),3e3)},check_for_cmd_click:function(t){var e=t.keyCode||t.which;if(13===e&&(t.metaKey||t.ctrlKey)){var a=$.Event("click",{target:this.submit_button.get(0)});return this.handle_submit(a),!1}},update_button_state:function(){var t=this.char_counter.current_chars(),e=this.char_counter.chars_left();0!==t||this.has_file?0>e?(this.char_counter.addClass("error"),this.submit_button.addClass("disabled")):(this.char_counter.hasClass("error")&&this.char_counter.removeClass("error"),this.submit_button.hasClass("disabled")&&this.submit_button.removeClass("disabled")):this.submit_button.addClass("disabled")},resize_textbox:function(t){var e=$(t.target),a=e.data("text-line-height"),s=parseInt(e.attr("data-current-height"),10),r=this.scrollHeight;a||(a=parseInt(e.css("line-height"),10),s=e.height(),e.css("overflow","hidden")),r>s&&(r+=1*a,e.height(r),e.attr("data-current-height",r))},handle_submit:function(t){return TAPP.lock_up($(t.target))}}),r=s.extend({events:function(){var t=s.prototype.events.call(this);return t=t.concat([["click","[data-remove-reply]","clean_reply_to"],["click","[data-reply-to]","handle_reply_to"]]),$("html").hasClass("touch")||t.push(["keyup","[data-message-create] [data-main-message]","resize_textbox"]),t},init:function(){this.post_textarea=$("[data-message-create] [data-main-message]"),this.in_reply_to=$("[data-message-create] [data-in-reply-to]"),this.in_reply_to_post_copy=this.in_reply_to.find("[data-post-copy]"),s.prototype.init.call(this)},init_char_counter:function(){this.char_counter=new a,this.char_counter.init(this.post_textarea,'[data-char-counter-for="message"]',{markdown_support:!0,perma_text:page_context.appended_post_url||""})},clean_reply_to:function(){return this.in_reply_to.get(0).className="hide",this.post_textarea.attr("data-in-reply-to-post-id",null),!1},handle_reply_to:function(t){var e=$(t.target),a=e.closest("[data-post-id]"),s=a.data("post-id"),r=a.attr("data-post-author-username"),n=page_context.viewer_username;this.in_reply_to_post_copy.html(a.html()),this.in_reply_to_post_copy.addClass(a.get(0).className),this.in_reply_to_post_copy.find(".post-footer").remove(),this.in_reply_to.removeClass("hide");var i=this.post_textarea.val();return i.match("@"+r)||n===r||this.post_textarea.val("@"+r+" "+i),this.post_textarea.attr("data-in-reply-to-post-id",s),$(window).scrollTop(this.post_textarea.scrollTop()+100),this.post_textarea.focusEnd(),this.char_counter.update_char_count(),!1},showing_error_message:!1,validate_post:function(t){var e=this.char_counter.max_chars();return this.showing_error_message?!1:""===t?(this.showing_error_message=!0,TAPP.dialogs.error_dialog("You must enter text before posting.",$.proxy(function(){this.showing_error_message=!1},this),{title:"<h3>Sorry</h3>"}),!1):this.char_counter.current_chars()>e?(this.showing_error_message=!0,TAPP.dialogs.error_dialog("Your post can't be longer than "+e+" characters.",$.proxy(function(){this.showing_error_message=!1},this)),!1):t},handle_submit:function(t){var e=s.prototype.handle_submit.call(this,t),a=parseInt(this.post_textarea.attr("data-in-reply-to-post-id"),10),r=$.trim(this.post_textarea.val());return this.create_post(r,a).always(e),!0},create_post:function(t,e,a){var s=$.Deferred(),r=this.validate_post(t);if(page_context.appended_post_url&&(r+=page_context.appended_post_url),!r)return s.reject(),s;var n={text:r,reply_to:e};return a&&(n.annotations=a),TAPP.appdotnet_api.post(n).done($.proxy(this.post_success,this)).fail($.proxy(this.post_failure,this))},post_success:function(t){this.post_textarea.val(""),this.char_counter.update_char_count(),this.clean_reply_to();var e=page_context.insert_post_client_side_based_on_entity,a=function(a){return _.any(t.data.entities[a],function(t){return e.name===t.name})},s=e&&a(e.type);page_context.insert_post_client_side||s?TAPP.stream_view.insert_item(TAPP.utils.emojify(t.data.html)):page_context.refresh_on_post_create?TAPP.stream_view.update_stream():page_context.after_post_goto?window.location=page_context.after_post_goto+"?post_id="+t.data.id:this.show_success_text(),$("[data-stream]").children().length<=0&&TAPP.stream_view.update_stream()},post_failure:function(t){var e,a;try{a=$.parseJSON(t.responseText)}catch(s){a=null}429===t.status?e="Please try your operation again in a moment.":400===t.status&&a&&a.meta.error_message.indexOf("Is not a valid url")>=0&&(e="One of the links in your post is invalid. Edit your post and try again."),e=e||"There was an error creating that post. Please wait a moment and try again",this.showing_error_message=!0,TAPP.dialogs.error_dialog(e,$.proxy(function(){this.showing_error_message=!1},this))}}),n={init_attachment:function(){var t=$("[data-message-create]"),e=new TAPP.FileUploadWidget(t);this.uploader=e.uploader,this.on_file&&t.on("file",$.proxy(this.on_file,this)),this.on_file_reset&&t.on("file_reset",$.proxy(this.on_file_reset,this)),this.on_upload_done&&t.on("upload_done",$.proxy(this.on_upload_done,this))},annotations_from_response:function(t){var e;return e="image"===t.data.kind?[{type:"net.app.core.oembed",value:{"+net.app.core.file":{file_token:t.data.file_token,format:"oembed",file_id:t.data.id}}}]:[{type:"net.app.core.attachments",value:{"+net.app.core.file_list":[{file_token:t.data.file_token,format:"metadata",file_id:t.data.id}]}}]},on_file:function(){this.has_file=!0},on_file_reset:function(){this.has_file=!1}},i=r.extend($.extend({},n,{init:function(){r.prototype.init.call(this),this.has_file=!1,Modernizr.filereader&&this.init_attachment()},create_post:function(t,e){var a=this,s=$.Deferred();this.submit_button.html('<i class="icon-refresh icon-spin"></i>');var r=function(t,r){return a.constructor.__super__.create_post.call(a,t,e,r).done(s.resolve).fail(s.reject)};return s.always(function(){a.submit_button.html("Post")}),this.has_file?this.uploader.upload_state.done($.proxy(function(e){var s=this.annotations_from_response(e),n=a.post_textarea.data("photo-url"),i=t.length>0?t+" â€” "+n:n;a.post_textarea.text(i),r(i,s).done(function(){a.uploader.reset_file_upload()})},this)).fail(function(){s.reject()}):r(t),s},on_file:function(){this.has_file=!0;var t=2,e=this.post_textarea.data("photo-url").length+3+t;this.char_counter.set_total_chars(this.char_counter.initial_char_count-e),this.char_counter._update_char_count(),this.update_button_state()},on_file_reset:function(){this.has_file=!1,this.char_counter.reset_char_counter(),this.char_counter._update_char_count(),this.update_button_state()}})),o=s.extend($.extend({},n,{events:function(){var t=s.prototype.events.call(this);return t.push(["char-count-updated","[data-message-create] [name=subject]","update_button_state"]),t},get_channel_id:function(){return parseInt($("[data-message-create][data-channel-id]").attr("data-channel-id"),10)},init:function(){this.message_textarea=$("[data-message-create] [data-main-message]"),this.subject_input=$("[data-message-create] [name=subject]"),this.read_more_input=$("[data-message-create] [name=read_more]"),this.image_preview_container=$("[data-message-create] [data-image-preview]"),s.prototype.init.call(this),this.init_attachment()},init_char_counter:function(){this.char_counter=new a,this.char_counter.init(this.message_textarea,'[data-char-counter-for="message"]',{markdown_support:!0,perma_text:page_context.appended_post_url||""}),this.subject_char_counter=new a,this.subject_char_counter.init(this.subject_input,'[data-char-counter-for="subject"]',{markdown_support:!0,perma_text:page_context.appended_post_url||""})},get_confirmation_modal:function(t){var e=TAPP.dialogs.markup_dialog('<div class="send-alert-box ta-center"><i class="icon-bullhorn"></i></div>',{title:'<h3 class="ta-center">Are you sure you want to send this broadcast?</h3>',backdrop:!1,buttons:{Cancel:{click:function(){e.modal("hide"),e.remove()},"class":"pull-left btn btn-small"},Send:{click:function(){e.modal("hide"),t(),e.remove()},"class":"pull-right btn btn-small btn-primary"}}});return e},handle_submit:function(t){$("[data-publish-adn-post-failed]").hide();var e=this.validate();if(e===!1)return!1;{var a=this,r=function(){var r=s.prototype.handle_submit.call(a,t),n=a.create_message(e);n.always(r)};this.get_confirmation_modal(r)}},validate:function(){var t=$.trim(this.subject_input.val()),e=$.trim(this.message_textarea.val()),a=$.trim(this.read_more_input.val()),s=$("[name=publish_to_adn_posts]").is(":checked"),r=$("[name=publish_to_twitter]").is(":checked"),n=$("[name=publish_to_facebook]").is(":checked");if(!t||""===t)return this.showing_error_message=!0,TAPP.dialogs.error_dialog("You must enter a subject.",$.proxy(function(){this.showing_error_message=!1},this),{title:"<h3>Sorry</h3>"}),!1;var i={};return n&&(i.facebook=!0),r&&(i.twitter=!0),s&&(i.adn_posts=!0),{subject:t,message:e,read_more:a,publish_to:i,entities:{parse_markdown_links:!0}}},create_message:function(t){var e=this,a=$.Deferred();this.submit_button.html('<i class="icon-refresh icon-spin"></i>'),a.always(function(){e.submit_button.html("Send Broadcast")});var s={};t.message&&""!==t.message?s.text=t.message:s.machine_only=!0,s.annotations=[{type:"net.app.core.broadcast.message.metadata",value:{subject:t.subject}}],t.read_more&&""!==t.read_more&&s.annotations.push({type:"net.app.core.crosspost",value:{canonical_url:t.read_more}}),s.entities=t.entities,s.publish_to=t.publish_to;var r=function(t){return TAPP.appdotnet_api.create_message(e.get_channel_id(),t).done(function(t){e.post_success(t),e.after_create_message(s,t)}).fail($.proxy(e.post_failure,e))};return this.has_file?this.uploader.upload_state.done(function(t){var n=e.annotations_from_response(t);s.annotations=s.annotations.concat(n),r(s).always(function(t){a.resolve(t)})}):r(s).always(function(t){a.resolve(t)}),a.promise()},after_create_message:function(t,e){if(t.publish_to.adn_posts){var a,s="",r="";_.each(e.data.annotations,function(t){"net.app.core.fallback_url"===t.type&&t.value&&(r=t.value.url)}),_.each(t.annotations,function(t){"net.app.core.broadcast.message.metadata"===t.type&&t.value?s=t.value.subject:"net.app.core.oembed"===t.type&&t.value&&t.value["+net.app.core.file"]&&(a={},$.extend(a,t),a.value.embeddable_url=r)});var n={text:s+" "+r};return a&&(n.annotations=[a]),TAPP.appdotnet_api.post(n).fail(function(){$("[data-publish-adn-post-failed]").show()})}},update_button_state:function(){var t=this.subject_char_counter.current_chars(),e=this.subject_char_counter.chars_left();0!==t||this.has_file?0>e?(this.char_counter.addClass("error"),this.submit_button.addClass("disabled")):(this.char_counter.hasClass("error")&&this.char_counter.removeClass("error"),this.submit_button.hasClass("disabled")&&this.submit_button.removeClass("disabled")):this.submit_button.addClass("disabled")},post_success:function(t){this.message_textarea.val(""),this.subject_input.val(""),this.read_more_input.val(""),this.uploader.reset_file_upload(),this.char_counter.update_char_count(),this.subject_char_counter.update_char_count(),this.show_success_text(t)},post_failure:function(t){var e,a;try{a=$.parseJSON(t.responseText)}catch(s){a=null}429===t.status?e="Please try sending that broadcast again in a moment.":400===t.status&&a&&a.meta.error_message.indexOf("Is not a valid url")>=0&&(e="One of the links in your broadcast is invalid. Edit your alert and try again."),e=e||"There was an error creating that broadcast. Please wait a moment and try again",this.showing_error_message=!0,TAPP.dialogs.error_dialog(e,$.proxy(function(){this.showing_error_message=!1},this))},on_file_reset:function(){this.has_file=!1,this.image_preview_container.addClass("hide")},on_upload_done:function(t,e){var a=$("<img/>").attr("src",e.data.url);this.image_preview_container.html(a).removeClass("hide")}})),c=s.extend({events:function(){var t=s.prototype.events.call(this);return $("html").hasClass("touch")||t.push(["keyup","[data-message-create] [data-main-message]","resize_textbox"]),t},init:function(){this.tweet_textarea=$("[data-message-create] [data-main-message]"),s.prototype.init.call(this)},init_char_counter:function(){this.char_counter=new a,this.char_counter.init(this.tweet_textarea,'[data-char-counter-for="tweet"]',{markdown_support:!1,perma_text:page_context.appended_post_url||""})},showing_error_message:!1,validate_post:function(t){var e=this.char_counter.max_chars();return this.showing_error_message?!1:""===t?(this.showing_error_message=!0,TAPP.dialogs.error_dialog("You must enter text before posting.",$.proxy(function(){this.showing_error_message=!1},this),{title:"<h3>Sorry</h3>"}),!1):this.char_counter.current_chars()>e?(this.showing_error_message=!0,TAPP.dialogs.error_dialog("Your post can't be longer than "+e+" characters.",$.proxy(function(){this.showing_error_message=!1},this)),!1):t},handle_submit:function(t){var e=s.prototype.handle_submit.call(this,t),a=$.trim(this.tweet_textarea.val());return this.create_post(a).always(e),!0},create_post:function(t){var e=$.Deferred(),a=this.validate_post(t);if(page_context.appended_post_url&&(a+=page_context.appended_post_url),!a)return e.reject(),e;var s={action:"send_tweet",tweet_text:a},r=this;return $.post(window.location,s).done(function(t){return t&&"error"===t.result?void $.proxy(r.post_failure,r)(t):void $.proxy(r.post_success,r)(t)}).fail($.proxy(this.post_failure,this))},post_success:function(t){this.tweet_textarea.val(page_context.pre_tweet_text||""),this.char_counter.update_char_count(),this.show_success_text(),$(this).trigger("tweet-success",t)},post_failure:function(){TAPP.dialogs.error_dialog()}});TAPP.AlertCreateWithAttachment=o,TAPP.MessageCreateAttachmentMixin=n,TAPP.TweetCreate=c,TAPP.post_create={init:function(){var t;t=Modernizr.filereader&&page_context.permit_attachments?new i:new r,t.init()},alert_init:function(){var t=new o;t.init()}}}();
!function(){TAPP.stream_view={init_stream:function(){this.setup_infinte_scroll()},update_stream:function(){TAPP.pau.pjax_load_page({url:window.location.href})},insert_item:function(t){t.addClass("higlight-fade");$("[data-stream]").prepend(t);setTimeout(function(){t.addClass("higlight-fade-in")},50)},get_items:function(t){var e=window.location.protocol+"//"+window.location.host+window.location.pathname;page_context.additional_stream_view_params&&$.extend(t,page_context.additional_stream_view_params);var a=e+"?"+$.param(t),o=$.Deferred();return $.get(a).done(function(t){var e=$(t),a=e.find("[data-stream]"),r={html:a.html(),before_id:a.data("before-id"),since_id:a.data("since-id"),more:a.data("more")};o.resolve(r)}),o},scroll_stream:function(t){var e,a=$("[data-stream]"),o={};o.before_id=pjax_context.infinte_scroll.before_id||a.data("before-id");var r="undefined"!=typeof pjax_context.infinte_scroll.more?pjax_context.infinte_scroll.more:a.data("more");return r?(e=function(t){pjax_context.infinte_scroll.before_id=t.before_id,pjax_context.infinte_scroll.more=t.more,a.append(TAPP.utils.emojify(t.html))},void this.get_items(o).done(e).done(t)):(t(),!1)},setup_infinte_scroll:function(){var t=!1,e=$(window),a=$(document),o=this,r=!1;pjax_context.infinte_scroll=pjax_context.infinte_scroll||{};var i=function(){if(t)return!1;var r=e.scrollTop()>a.height()-e.height()-800;r&&(t=!0,$("[data-stream-loader]").removeClass("hide"),o.scroll_stream(function(){$("[data-stream-loader]").addClass("hide"),t=!1}))},n=function(){r=!0};e.tapp_on("touchstart",function(){e.on("touchmove.scroll",n)}),e.tapp_on("touchend",function(){e.off("touchmove.scroll")}),e.tapp_on("scroll",n),TAPP.setInterval(function(){r&&(r=!1,i())},100)},init_mute_user:function(){$("body").tapp_on("click","[data-post-mute-user]",function(){var t=$(this).closest("[data-post-id]"),e=$(t).data("post-author-username"),a=$(t).data("post-author-id");return TAPP.pau.mute_user($("[data-mute-user]"),a,e,0,!0),!1})},init_post_report:function(){var t=function(t,e,a,o){var r=$('[data-post-author-id="'+a+'"]'),i=TAPP.lock_up(t);r.addClass("hide"),TAPP.appdotnet_api.report_post(e,o).always(i).fail(function(){r.removeClass("hide"),TAPP.dialogs.error_dialog("There was an error while reporting this post. Wait a moment, and try again")}).done(function(){r.remove()})};$("body").tapp_on("click","[data-post-report]",function(){var e,a=$(this),o=$(this).closest("[data-post-id]"),r=$(o).data("post-id"),i=$(o).data("post-author-id"),n={Cancel:{click:function(){e.remove()}},Mute:{click:function(){var o=$(this).closest(".modal"),n=$("select",o).find("option:selected").val();return t(a,r,i,n),e.remove(),!1},text:"Report this post","class":"btn btn-small btn-danger"}},s={title:"<strong>Report this post</strong>",buttons:n},d=$("[data-report-post-form]");return e=TAPP.dialogs.markup_dialog(d,s).show(),!1})},init_post_delete:function(){var t=function(t){var e=t.find(".post-content");e.html(t.attr("data-redacted")),t.removeClass("deleted")},e=function(t){var e=t.find(".post-content");t.attr("data-redacted",e.html()),e.text("[deleted]"),t.addClass("deleted")},a=function(a,o){var r=o.data("post-id"),i=TAPP.lock_up(a),n=1===o.data("post-remove-from-page")?!0:!1;n?o.addClass("hide"):e(o),TAPP.appdotnet_api.delete_post(r).always(i).fail(function(){n?o.removeClass("hide"):t(o),TAPP.dialogs.error_dialog("We were unable to delete that post. Wait a moment, and try again")}).done(function(){n?o.remove():o.attr("data-redacted",null)})};$("body").tapp_on("click","[data-post-delete]",function(){var t,e=$(this),o=$(this).closest("[data-post-id]"),r={Cancel:{click:function(){t.remove()}},Delete:{click:function(){return a(e,o),t.remove(),!1},text:"Delete","class":"btn btn-small btn-danger"}},i={title:"<strong>Delete Post</strong>",buttons:r};return t=TAPP.dialogs.markup_dialog("Are you sure you want to delete this post?",i),t.show(),!1})},init_star_post:function(){$("body").tapp_on("click","[data-star-button]",function(){var t=$(this),e=$(this).find("i"),a=$(this).data("post-id"),o=parseInt(t.attr("data-starred"),10),r=-1;if(1===o)r=0;else{if(0!==o)return!1;r=1}var i=TAPP.lock_up(t);return e.toggleClass("icon-star").toggleClass("icon-star-empty"),t.attr("data-starred",r),TAPP.appdotnet_api.star_post(a,r).always(i).fail(function(){e.toggleClass("icon-star").toggleClass("icon-star-empty"),t.attr("data-starred",o);var a="0"===r?"un":"";TAPP.dialogs.error_dialog("Unable to "+a+"star this post. Wait a moment, and try again")}),!1})},init_repost:function(){var t=this;$("body").tapp_on("click","[data-repost-button]",function(){var e=$(this),a=e.closest(".post-container"),o=$(this).find("i"),r=$(this).data("post-id"),i=parseInt(e.attr("data-reposted"),10),n=-1;if(1===i)n=0;else{if(0!==i)return!1;n=1}var s=TAPP.lock_up(e),d=e.attr("title"),l=1===n?"remove repost":"repost";return o.toggleClass("reposted"),e.attr("data-reposted",n),e.attr("title",l),t.decorate_repost(a,n),TAPP.appdotnet_api.repost_post(r,n).always(s).fail(function(){o.toggleClass("reposted"),e.attr("data-reposted",i),e.attr("title",d),t.decorate_repost(a,i),TAPP.dialogs.error_dialog("Unable to "+d+". Wait a moment, and try again")}),!1})},decorate_repost:function(t,e){var a=t.find(".footer-top"),o=t.find(".post-reposted-by"),r=function(t){o.length?o.replaceWith(t):a.prepend(t)},i=function(t){return $("<p>").append(t.clone()).html()},n=t.attr("data-old-repost-html");if(n)t.attr("data-old-repost-html",i(o)),r(n);else{n=i(o),t.attr("data-old-repost-html",n);var s;s=1===e?'<div class="post-reposted-by yui3-u"><span class="reposted-by-text"><i class="icon-repost"></i><span> Reposted by <a href="/'+page_context.viewer_username+'">you</a></span></span></div>':"",r(s)}},init_stream_marker:function(){TAPP.utils.on_window_load(function(){TAPP.pau.scroll_post_into_view(page_context.stream_marker_post_id,"stream-highlight").done(function(){$(window).trigger("viewport-ready")})});var t=!1,e=$("[data-backfill-control]"),a=e.closest(".backfill-container"),o=this;$("body").tapp_on("click","[data-backfill-control]",function(){var r={before_id:e.data("before-id"),since_id:parseInt(e.attr("data-since-id"),10),backfill:"0",count:-200},i=$(this),n=i.closest(".content").find(".spinner-container");return t=!0,i.addClass("hide"),n.removeClass("hide"),o.get_items(r).done(function(t){a.after(TAPP.utils.emojify(t.html)),TAPP.pau.scroll_post_into_view(t.before_id),i.removeClass("hide"),n.addClass("hide"),t.more?e.attr("data-since-id",t.since_id):a.addClass("hide")}),!1});var r=function(t,e,a,o){TAPP.appdotnet_api.update_stream_marker(page_context.stream_marker_name,e).always(a).fail(o)},i=_.debounce(r,1e4),n=function(t,e,a){var o=t.closest("[data-post-id]"),n=o.data("post-parent-id"),s=n||o.data("post-id"),d=TAPP.lock_up(t),l=$("[data-post-id].stream-highlight"),p=page_context.stream_marker_post_id;page_context.stream_marker_post_id=s,l.removeClass("stream-highlight"),o.addClass("stream-highlight");var c=function(){l.addClass("stream-highlight"),o.removeClass("stream-highlight"),page_context.stream_marker_post_id=p,e&&TAPP.dialogs.error_dialog("Unable to update the stream marker. Wait a moment, and try again")},_=a?i:r;return _(page_context.stream_marker_name,s,d,c)};$("body").tapp_on("click","[data-set-stream-marker]",function(){var t=$(this);return n(t,!0),!1});var s=$(window),d=function(t){var e=s.scrollTop()+60,a=e+s.height(),o=t.offset().top;return a>=o&&o>=e},l=function(){var e=$(".post-container");return!e.length||t?(t=!1,!0):void e.each(function(){var t=$(this);if(t.data("post-id")&&d(t)){if(parseInt(t.data("post-id"),10)<=page_context.stream_marker_post_id)return!1;var e=$(t.find("[data-set-stream-marker]"));return e.length?(n(e,!1,!0),!1):!1}})};$(window).tapp_on("viewport-ready",function(){s.tapp_on("scroll",_.debounce(l,500))})}},TAPP.register_post_load_hooks({init_stream:TAPP.stream_view.init_stream,init_post_delete:TAPP.stream_view.init_post_delete,init_mute_user:TAPP.stream_view.init_mute_user,init_post_report:TAPP.stream_view.init_post_report,init_star_post:TAPP.stream_view.init_star_post,init_repost:TAPP.stream_view.init_repost,init_stream_marker:TAPP.stream_view.init_stream_marker},TAPP.stream_view)}();
!function(){TAPP.follow={init_follow:function(){var t=this,a=function(a){var e,o=$(a),n=o.data("user-id"),s=parseInt(o.attr("data-follow-status"),10);e=1===s?0:1;var i=o.closest("[data-follow-details]");t.update_follow_state(o,e,i),TAPP.appdotnet_api.follow(n,e).fail(function(a){var n=JSON.parse(a.responseText);t.update_follow_state(o,s,i),507===a.status?TAPP.dialogs.upgrade_dialog(n.meta.error_message,"Nice! You've followed a bunch of accounts.",function(){window.location=page_context.subscribe_url}):TAPP.dialogs.error_dialog("There was a problem "+(0===e?"un":"")+"following this user. Please wait a moment and try again.")}).done(function(){o.trigger("follow-state-change",[e]),1===e&&t.after_follow()})};$("body").tapp_on("click","[data-follow-btn]",function(){a(this)});var e=function(t,a,e,o){var n=$.map(a.find("[data-follow-btn]"),function(t){return $(t).data("user-id")}),s={action:t,user_ids_on_page:n,num:e||1};o&&(s.user_id=o);var i=$.ajax({url:window.location,type:"POST",data:s});return i};$("body").tapp_on("click","[data-follow-suggestions] [data-not-interested-btn], [data-follow-suggestions] [data-follow-btn]",function(){var t,a,o,n=$(this),s=n.closest(".suggested-users-list"),i=n.closest(".user-follow-container");return n.is("[data-not-interested-btn]")?(a=n.data("user-id"),t="dont_suggest_user",o=e(t,s,1,a)):(t="next_suggestion",o=e(t,s,1)),o.done(function(t){var a=t.html;i.replaceWith(a[0])}),!1}),$("body").tapp_on("click","[data-refresh-all-suggestions]",function(){var t="next_suggestion",a=$(".suggested-users-list"),o=e(t,a,12);return o.done(function(t){var e=t.html;a.find(".user-follow-container").each(function(t,a){e.length?$(a).replaceWith(e.pop()):$(a).hide()})}),!1})},update_button_state:function(t,a,e,o){return parseInt(e.attr(t),10)===o?!1:(e.attr(t,o).toggleClass(a).toggleClass("btn-primary"),!0)},update_subscribe_state:function(t,a){this.update_button_state("data-subscribe-status","subscribed",t,a)},update_recommend_state:function(t,a){this.update_button_state("data-recommend-status","recommended",t,a)},update_follow_state:function(t,a,e){var o=this.update_button_state("data-follow-status","following",t,a);if(o){var n=1===a?1:-1;TAPP.follow.update_follow_stats(e,n)}},update_follow_stats:function(t,a){var e=t.find(".follow-to"),o=e.find("[data-follow-to-count]"),n=parseInt(o.attr("data-follow-to-count"),10),s=e.find(".text"),i=n+a,r=s.text(),l=r;1===n?l=" Followers":1===i&&(l=" Follower"),o.text(TAPP.utils.intcomma(i)).attr("data-follow-to-count",i),s.text(l)},after_follow:function(){page_context.promote_related_broadcasts&&TAPP.pau.promote_related_broadcasts_dialog()},intent_follow:function(){$("body").tapp_on("follow-state-change","[data-follow-btn]",function(){window.location=page_context.after_follow_goto})},intent_subscribe:function(){$("body").tapp_on("subscribe-state-change","[data-subscribe-btn]",function(){window.location=page_context.after_subscribe_goto})},init_subscribe:function(){var t=this,a=function(a){var e=$(a),o=e.data("channel-id"),n=parseInt(e.attr("data-subscribe-status"),10),s=1===parseInt(e.attr("data-one-time"),10),i=1===parseInt(e.attr("data-changed"),10),r=e.attr("data-undo-url");if(s&&i)return window.open(r,"_blank"),!1;var l;l=1===n?0:1;var d=e.closest("[data-subscribe-details]");t.update_subscribe_state(e,l,d),s&&(e.addClass("subscribed-final"),e.attr("data-changed",l)),TAPP.appdotnet_api.subscribe_channel(o,l).fail(function(a){JSON.parse(a.responseText);t.update_subscribe_state(e,n,d),s&&(e.removeClass("subscribed-final"),e.attr("data-changed",n)),TAPP.dialogs.error_dialog("There was a problem "+(0===l?"un":"")+"subscribing. Please wait a moment and try again.")}).done(function(){e.trigger("subscribe-state-change",[l]),1===l&&t.after_subscribe()}).always(function(){var t;if(page_context.alert_detail_page)t="alert-detail";else{if(!page_context.channel_detail_page)return;t="channel-promo"}var a="subscribe";1===n&&(a="unsubscribe"),TAPP.event_tracking.track_event(t+"-subscribe-click",{logged_in:!!page_context.omo_user_id,channel_id:o,action:a})})};$("body").tapp_on("click","[data-subscribe-btn]",function(){a(this)})},after_subscribe:function(){page_context.subscribe_popup&&TAPP.oahu.subscribe_popup()},init_recommend:function(){var t=this,a=function(a){var e,o=$(a),n=o.data("app-id"),s=parseInt(o.attr("data-recommend-status"),10);e=1===s?0:1;var i=o.closest("[data-recommend-details]");t.update_recommend_state(o,e,i),TAPP.appdotnet_api.recommend_app(n,e).fail(function(a){JSON.parse(a.responseText);t.update_recommend_state(o,s,i),TAPP.dialogs.error_dialog("There was a problem "+(0===e?"un":"")+"recommending. Please wait a moment and try again.")}).done(function(){o.trigger("recommend-state-change",[e])})};$("body").tapp_on("click","[data-recommend-btn]",function(){a(this)})}},TAPP.register_post_load_hooks({init_follow:TAPP.follow.init_follow},TAPP.follow)}();
!function(){TAPP.photo={init:function(){$("meta[name=viewport]").attr("content","width=device-width, initial-scale=1, maximum-scale=10");var t=function(){var t=$(".image-container"),i=t.find("img"),a=i.attr("data-full-width"),n=i.attr("data-full-height"),e=t.height(),o=t.width(),d=TAPP.utils.fit_to_box(a,n,o,e),c=d[0],h=d[1];i.hide(),i.attr({width:c,height:h}),i.css({"margin-top":-1*h/2,"margin-left":-1*c/2}),i.show()},i=$(".image-container img"),a=!1,n=$(".loader");setTimeout(function(){a||n.show()},250),t(),i.imagesLoaded().done(function(){a=!0,i.addClass("first-load"),n.hide()}),$(window).tapp_on("resize",_.debounce(function(){t()},50)),$(".image-container").tapp_on("click",function(){$("[data-post-container]").toggle()})}}}(TAPP);